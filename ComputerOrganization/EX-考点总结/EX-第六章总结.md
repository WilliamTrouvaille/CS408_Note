# EX-第六章 总线总结

## 导读

### 【考纲内容】

1. 总线的基本概念
2. 总线的组成及性能指标
3. 总线事务和定时

### 【复习提示】

1.   选择题：总线的特点、猝发传输方式、性能指标、定时方式。

2.   综合题：总线带宽的计算。

## 考点总结

### 总线概述

1.   总线：一组能为多个部件分时共享的公共信息传送线路。分时和共享是总线的两个特点。

     1.   共享是指总线上可以挂接多个部件，各个部件之间可以一条总线互相交换信息。
     2.   分时是指同一时刻只允许有一个部件向总线发送信息。而从总线接收数据的设备可以有多个，因为接收数据的设备不会对总线产生“干扰”。

2.   总线设备：总线上所连接的设备，按其对总线有无控制功能可分为主设备和从设备两种。

     1.   主设备：指获得总线控制权的设备。 
     2.   从设备：指被主设备访问的设备，它只能响应从主设备发来的各种总线命令

3.   总线特性

     1. 机械特性：尺寸、形状、管脚数、排列顺序。
     2. 电气特性：传输方向和有效的电平范围。
     3. 功能特性：每根传输线的功能（地址、数据、控制）。
     4. 时间特性：信号的时序关系

4.   总线分类

     1.   **片内总线**：片内总线是芯片内部的总线，是$CPU$芯片内部寄存器与寄存器之间、寄存器与$ALU$之间的公共连接线。
     2.   **系统总线**：系统总线是计算机系统内各功能部件（$CPU$、主存、$I/O$接口）之间相互连接的总线，按系统总线传输信息内容的不同，又可分为：
          1.   数据总线$DB$：在内存、寄存器、输入输出设备和其他组件之间数据信息，包括指令和操作数。是双向传输总线。其**位数与机器字长、 存储字长有关**。
          2.   地址总线$AB$：将$CPU$发出的读取或写入操作的目标地址传递给内存或外设。是单向传输总线。地址总线的位数与**主存地址空间的大小**有关，
          3.   控制总线$CB$：在计算机系统中传递各种控制信息，协调各个组件的操作。
     3.   **$I/O$总线**：$I/O$总线主要用于连接中低速的$I/O$设备，通过$I/O$接口与系统总线相连接。目的是将低速设备与高速总线分离，以提升总线的系统性能。常见的有$USB$、$PCI$总线。
     4.   **通信总线/外部总线**：通信总线是用于计算机系统之间或计算机系统与其他系统（如远程通信设备、测试设备）之间信息传送的总线

5.   总线结构

     1.   单总线结构：将各功能部件都连接在一组总线上，允许$I/O$设备之间、$I/O$设备和$CPU$之间或$I/O$设备与主存之间直接交换信息。单总线并不是指只有一根信号线，系统总线按传送信息的不同可以细分为地址总线、数据总线和控制总线。

          优点：结构简单，成本低，易于接入新的设备。

          缺点：带宽低、负载重，多个部件只能争用唯一的总线，且不支持并行传输操作。

     2.   双总线结构：主存总线（用于$CPU$、主存和**通道**之间进行数据传送），和$I/O$总线（用于多个外部设备与**通道**之间进行数据传送）。

          1.   通道是具有特殊功能的处理器，能对$I/O$设备进行统一管理，**通道程序存放在主存中**。
          2.   支持**突发传送/猝发传送**：第一次发地址，后面直接传数据，减少了发地址的时间就增加了传输率。

          优点：将较低速的$I/O$设备从单总线上分离出来，实现存储器总线和$I/O$总线分离。

          缺点：需要增加通道等硬件设备。

     3.   三总线结构：主存总线（$CPU$和主存）、$I/O$总线（$CPU$和$I/O$接口）和**直接内存访问总线**$DMA$（外设与主存）。

          优点：提高了$I/O$设备的性能，使其更快地响应命令，提高系统吞吐量。

          缺点：系统工作效率较低。

6.   总线标准*，了解$USB$ $(Universal \;Serial\; Bus)$：属于设备总线，是设备和设备控制器之间的接口。可以热插拔、即插即用。

7.   性能指标

     1.   总线周期/总线传输周期：一次总线操作所需的时间（包括申请阶段、寻址阶段、传输阶段和结束阶段），总线传输周期通常由若干总线时钟周期构成。
     2.   总线时钟周期： 即机器的时钟周期，计算机有一个统一的时钟，以控制整个计算机的各个部件，总线也要受此时钟的控制。
     3.   总线工作频率：总线上各种操作的频率，为总线周期的倒数。若总线周期=$N$个时钟周期，则总线的工作频率=时钟频率$\div N$。
     4.   总线时钟频率：即机器的时钟频率，为时钟周期的倒数。若时钟周期为$T$，则时钟频率为$1/T$。
     5.   总线宽度/总线位宽：总线上同时能够传输的数据位数，通常是指**数据总线的根数**，如$32$根称为$32$位（$bit$）总线。
     6.   总线带宽：**在描述总线传输速率时$K=10^3$**。可理解为总线的数据传输率，即单位时间内总线上可传输数据的位数，通常用每秒钟传送信息的字节数来衡量，单位可用字节/秒$B/s$表示。总线带宽=总线工作频率$\times$总线宽度（$bit/s$）。
     7.   总线复用：一种信号线在不同的时间传输不同的信息。可以使用较少的线传输更多的信息，从而节省了空间和成本。**并不能提高传输率**。
     8.   信号线数：地址总线、数据总线和控制总线三种总线数的总和称为信号线数。

8.   总线事务：从请求总线到完成总线使用的操作序列。是在**一个总线周期中**发生的一系列活动。

9.   **突发传送/猝发传送**：能够进行连续成组数据的传送，其寻址阶段发送的是连续数据单元的首地址，在传输阶段传送多个连续单元的数据，每个时钟周期可以传送一个字长的信息，但是不释放总线，直到一组数据全部传送完毕后，再释放总线。

10.   总线定时：指总线在双方交换数据的过程中需要时间上配合关系的控制。实质是一种协议或规则。

      1.   同步通信/同步定时方式：系统采用一个统一的时钟信号来协调发送和接收双方的传送定时关系。
           1.   一次总线事务不一定在一个时钟周期内完成，即**时钟频率不一定等于工作频率**。
           2.   适用于**总线长度较短**及**总线所接部件的存取时间比较接近**的系统。
      2.   异步通信/异步定时方式/应答方式：没有统一的时钟，也没有固定的时间间隔，完全依靠传送双方相互制约的“握手”信号来实现定时控制。传送操作是由双方按需求分配时间。每次握手的过程完成一次通信， 一次通信往往会交换多位而非一位数据。根据“请求”和“回答”信号的撤销足否互锁，又可分为（从上到下可靠性逐渐提高，数据逐渐变慢）
           1.   不互锁方式：主设备发出“请求”信号后，不必等到接到从设备的“回答”信号，而是经过一段时间，便撤销“请求”信号。
           2.   半互锁方式：主设备发出“请求”信号后，必须待接到从设备的“回答”信号后，才撤销“请求”信号，有互锁的关系。
           3.   全互锁方式：主设备发出“请求”信号后，必须待从设备“回答”后，才撤销“请求”信号；从设备发出“回答”信号，必须待获知主设备“请求”已撤销后，再撤销其“回答”信号。

