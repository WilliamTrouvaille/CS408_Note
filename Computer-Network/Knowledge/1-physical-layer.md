# 第二章 物理层

## 导读

### 【考纲内容】

1.   通信基础
     +   信道、信号、带宽、码元、波特、速率、信源与信宿等基本概念
     +   奈奎斯特定理与香农定理
     +   编码与调制
     +   电路交换、报文交换与分组交换
     +   数据报与虚电路
2.   传输介质
     +   双绞线、同轴电缆、光纤与无线传输介质
     +   物理层接口的特性
3.   物理层设备
     +   中继器
     +   集线器

### 【知识导图】



### 【复习提示】

+   物理层考虑的是怎样才能在连接各台计算机的传输媒体上传输数据比特流，而不是指具体的传输媒体
+   本章概念较多，易出选择题，且涉及一些通信原理，读者不太明白的地方可以参考一些相关书籍，通信部分的内容也并非考研重点
+   ==复习时应抓住重点，如奈奎斯特定理和香农定理的应用、编码与调制技术、数据交换方式，以及电路交换、报文交换与分组交换技术等。==

## 通信基础

物理层需要考虑如何传输比特流，而不关心到底使用何种媒体传输数据

>   传输信息所利用的一些物理媒体，如双绞线、光缆、无线信道等，并不在物理层协议之内而在物理层协议下面。因此，有人把物理媒体当作第0层。

### 基本概念

#### 数据、信号与码元

+   数据是指传送信息的实体
+   信号则是数据的电气或电磁表现，是数据在传输过程中的存在形式
+   数据和信号都可用“模拟的”或“数字的”来修饰
    1.   ==连续变化==的数据/信号称为==模拟数据/模拟信号==
    2.   取值仅允许为==有限的几个离散数值==的数据/信号称为==数字数据/数字信号==
+   数据传输方式可分为串行传输和并行传输
    +   串行传输是指一比特一比特地按照时间顺序传输
        +   ==远距离通信通常采用串行传输==
        +   速度慢、费用低、适合远距离。
    +   并行传输是指若干比特通过多条通信信道同时传输
        +   速度快、费用高、适合近距离
+   码元是指用一个固定时长的信号波形（数字脉冲）表示一位$k$进制数字，代表不同离散数值的基本波形，是数字通信中数字信号的计量单位，这个时长内的信号称为左进制码元，而该时长称为码元宽度
    +   $1$码元可以携带若干比特的信息量
        +   例如，在使用二进制编码时，只有两种不同的码元：一种代表`0`状态，另一种代表`1`状态。

#### 信源、信道与信宿

+ 信源：产生和发送数据的源头。
    + 通常是计算机或其他数字终端装置
+ 信宿：接受数据的终点。
    + 通常是计算机或其他数字终端装置
+ 信道：信号的传输媒介。
    + 分类
        + 按传输信号形式的不同：模拟信道、数字信道。
        + 按传输介质的不同：有线信道、无线信道。
    + 信道与电路并不等同，信道是信号的传输媒介
        + 一个信道可视为一条线路的逻辑部件，一般用来表示向某个方向传送信息的介质，因此一条通信线路往往包含一条发送信道和一条接收信道
        + 噪声源是信道上的噪声（即对信号的干扰）及分散在通信系统其他各处的噪声的集中表示。 
    + 信道上传送的信号有基带信号和宽带信号之分
        + ==基带信号==将==数字信号==1和0直接用两种==不同的电压==表示，然后送到==数字信道==上传输
            + 称为==基带传输==
        + ==宽带信号==将==基带信号==进行调制后形成==频分复用模拟信号==，然后送到==模拟信道==上传输
            + 称为==宽带传输==
    + 信道的极限容量是指==信道的最高码元传输速率或信道的极限信息传输速率==

+   通信过程
    +   信源$\to$数字信号$\to$调制解调器$\to$模拟信号$\to$广域网$\to$模拟信号$\to$调制解调器$\to$数字信号$\to$信宿。
    +   图`2.1`所示为一个单向通信系统的模型
        +   实际的通信系统大多为双向的，即往往包含一条发送信道和一条接收信道，此时信道可以进行双向通信

![image-20230726122438001](https://trouvaille-oss.oss-cn-beijing.aliyuncs.com/picList/202307261224064.png)

#### 通信方式

+ 单工通信：只能单方面通信，只需一条信道。
    + 无线电广播
    + 电视广播

+ 半双工通信：能发送和接受，但是任何一方都不能同时发送和接收信息，需要两条信道。
+ 全双工通信：都能发送与接受，需要两条信道。

#### 信号类型

+ 基带传输：
    - 将数字信号直接用两种不同的电压表示，不用调制，直接送到数字信道上传输。
    - 是来自信源的信号，如计算机输出的表示文字或多媒体的数据信号，即发出的直接表达了要传输的信息的信号。
    - 传输媒体整个带宽都被基带信号占用。
    - 适用于近距离传输，通常用于局域网等场景。
    - 例如，用高低高低电平表示数字`1010`。
- 频带传输：
  - 将基带信号对特定频率的载波进行调制后进行的频分复用模拟信号，再传输到模拟信道上传输。
  - 将低频的基带信号进行载波调制后将信号的频率范围移动到较高频段以便在信道中传输。
  - 适用于远距离传输，通常与无线传输相关。
  - 可以解决电话系统传输数字信号的问题，同时可以实现多路复用技术。
  - 例如，用频带传输一个码元A相当于传输数字`1010`

- 宽带传输：
  - 基于频带传输，使用频分复用等技术将链路容量分解为两个或多个信道，每个信道可以携带不同的信号。
  - 信道直接互不干扰，提高传输效率，可以同时传输多路信号。
  - 适用于高速远距离传输，如宽带互联网等。
  - 宽带传输在频带传输的基础上实现了信号的分隔传输，每个信道可独立传输不同的信息。
  - 宽带传输提供了更高的传输带宽和更高的传输速率，适用于多种应用，如高清视频、音频传输等。

### 传输单位

![img](https://img.ithome.com/newsuploadfiles/2023/5/f4940502-0135-45ba-90f9-5199a1e62b6e.png?x-bce-process=image/format,f_auto)

#### 码元

+   码元是指用一个固定时长的信号波形（数字脉冲）表示一位$k$进制数字，代表不同离散数值的基本波形，是数字通信中数字信号的计量单位，这个时长内的信号称为左进制码元，而该时长称为码元宽度
    +   $1$码元可以携带若干比特的信息量
        +   例如，在使用二进制编码时，只有两种不同的码元：一种代表`0`状态，另一种代表`1`状态。

#### 波特$Baud/B$

+   指一秒可以传输多少个码元（电平）。一波特就是一码元一秒。
+   比特率=波特率$\times\log_2$(码元表示有效离散值个数)。

#### 速率$Rate/R$

+   分为信息传输速率与码元传输速率。
    - 信息传输速率：用字母R表示，单位为bps（比特每秒）。
    - 码元传输速率：用字母B表示，单位为Bd（波特，即码元每秒）。

+   信息传输速率就是$b/s$，就是我们平常说的网速。
+   码元传输速率就是指一秒可以传输多少个码元，即单位时间内脉冲个数或信号变化的次数
+   码元可以理解为几个比特的集合，所以信息传输速率（网速）=码元传输速率x码元所带信息量（多少比特）
    +   单位为波特
    +   ==波特传输率与进制无关==
+   码元所带信息量（比特数）=$\log2\,$(码元进制数/码元种数)。

#### 带宽（Band Width）

用来表示最高数据速率。

信道带宽指信道最高通过频率与最低通过频率之差，单位为赫兹。

### 传输准则

#### 奈式准则（奈奎斯特定理、$Nyquist$）

+   奈氏准则规定避免**码间串扰**的低通信道最高码元传输速率。
    +   具体的信道所能通过的频率范围总是有限的
    +   信号中的许多高频分量往往不能通过信道， 否则在传输中会衰减，导致接收端收到的信号波形失去码元之间的清晰界限，这种现象称为**码间串扰**

在理想低通条件下，避免码间串扰：
$$
B=2W\\
R=2W\log_2V
$$
其中

+   $B$表示理想低通信道下的极限==码元传输速率==
    +   单位是$Bd$
        +   波特，即码元每秒
+   $R$表示理想低通信道下的极限==数据传输速率==
    +   单位为$bps$或$b/s$
        +   这俩都是比特每秒
        +   $p$表示$per$和``'/'``一样表示"每"
+   $W$是理想低通信道的带宽
    +   理想低通信道：没有噪声、带宽有限
    +   全部计算机网络中涉及电子通信领域的就奈式准则和香农定理这两个公式
        +   ==只有这两个公式中带宽的单位是$Hz$==
+   $V$表示每个码元离散电平的数目
    +   码元的离散电平数目是指有多少种不同的码元，比如有16种不同的码元，则需要4个二进制位
    +   因此数据传输速率是码元传输速率的4倍

---

对于奈氏准则，可以得出以下结论：

1. 由于码元的传输速率受奈氏准则的制约，但并未对信息传输速率给出限制，就必须设法使每个码元能携带更多的个比特量的信息，这就需要多元制的调制方法。
2. 在任何信道中，==码元传输速率==是有上限的
    +   ==若传输速率超过此上限，就会出现严重的码间串扰问题==，使得接收端不可能完全正确识别码元。
    +   限制的是==码元传输速率$B$==不是==数据传输速率$==R$
3. 信道的频带越宽（即通过的信号高频分量越多），就可用更高的速率进行码元的有效传输。

---

>   **理想低通**信道具有以下特征：
>
>   1. 理想低通信道可以完美地传输所有低于其截止频率的信号，而将高于截止频率的信号完全阻断。
>
>   2. 理想低通信道没有衰减或失真。
>
>   3. 理想低通信道的幅频响应是一个矩形函数，截止频率处突变。
>

#### 香农$Shannon$定理

香农定理规定了==带宽受限且有高斯白噪声干扰的信道==的极限数据传输速率，当用此速率进行传输时，可以做到不产生误差。香农定理定义为
$$
R=Wlog_2{(1+S/N)}
$$
其中

+   $R$表示信道的极限==数据传输速率==

    +   单位为$bps$或$b/s$
        +   这俩都是比特每秒
        +   $p$表示$per$和`/`一样表示"每"

+   $W$是信道的==带宽==

    +   全部计算机网络中涉及电子通信领域的就奈式准则和香农定理这两个公式
        +   ==只有这两个公式中带宽的单位是$Hz$==

+   $S/N$表示==信噪比==

    +   $S$为信道所传输信号的==平均功率==
        +   单位为瓦特$W$
    +   $N$为信道内部的==高斯噪声功率==
        +   单位为瓦特$W$

    +   计算公式
        $$
        S/N=10\cdot\log_{10}{\dfrac{S}{N}}
        $$

        +   其中$S/N$表示信噪比，$\dfrac{S}{N}$表示他们之间的比值就只是一个单纯的比值，不要搞混了

    +   较高的信噪比值表示信号相对较强，而噪声相对较弱，这对于通信系统的性能和可靠性至关重要

    +   单位是分贝$dB$

        +   采用分贝表示的原因是很多时候，信号要比噪声强得多
            +   比如信号比噪声强$10$亿倍，如果用数值表示的话，那么$1$后面有$9$个$0$，很容易丢失一个$0$
            +   如果用分贝表示只为$90dB$，要简单得多，而且不容易出错
            +   分贝对于表示特别大或特别小的数值极为有利，这种表示方式在电子通信领域用途很广。
        +   这个单位不是波特$Bd$

    +   怕搞混可以看看这个公式(当然408考试别写这个)

        $$
        SNR = 10 \cdot \log{10}\left(\frac{P{_\text{signal}}}{P_{\text{noise}}}\right)
        $$
        其中：

        +   $SNR(Signal-to-Noise \;Ratio)$信噪比
        +   $P_{\text{signal}}$ 表示信号的功率（信号的能量或幅度的平方）。

        - $P_{\text{noise}} $表示噪声的功率（噪声的能量或幅度的平方）。

---

对于香农定理，可以得出以下结论：

1.   信道的带宽或信道中的信噪比越大，信息的极限传输速率越高。
2.   对一定的传输带宽和一定的信噪比，信息传输速率的上限是确定的。
3.   只要信息传输速率低于信道的极限传输速率，就能找到某种方法来实现无差错的传输。
4.   香农定理得出的是极限信息传输速率，实际信道能达到的传输速率要比它低不少。 

#### 奈氏准则与香农定理区别

+   奈氏准则指出，==码元传输的速率==是受限的，不能任意提高
    +   否则接收端就不能正确判定码元所携带的比特是$1$还是$0$
    +   因为存在码元之间的相互干扰

+   奈氏准则是在理想条件下推导出来的
    +   在实际条件下，最高码元传输速率要比理想条件下得出的数值小很多
    +   电信技术人员的任务就是要在实际条件下，寻找出较好的传输码元波形，将比特转换为较为合适的传输信号。

+   需要注意的是，奈氏准则并未限制信息传输速率（$b/s$）。
+   要提高信息传输速率，就必须使每个传输的码元能够代表许多比特的信息，这就需要有很好的编码技术
    +   但码元所载的比特数确定后，信道的极限数据率也就确定了。
+   香农定理给出了信息传输速率的极限
    +   即对于一定的传输带宽（单位为$Hz$）和一定的信噪比，信息传输速率的上限就确定了，这个极限是不能突破的
    +   要想提高信息传输速率，要么设法提高传输线路的带宽，要么设法提高所传信道的信噪比，此外没有其他任何办法。
+   香农定理告诉我们，若要得到无限大的信息传输速率，只有两个办法
    1.   要么使用无限大的传输带宽（这显然不可能)
    2.   要么使信号的信噪比无限大
         +   即采用没有噪声的传输信道或使用无限大的发送功率（显然这也不可能）。
+   奈氏准则和香农定理中“带宽”的单位都是$Hz$。
    +   且只有这两个地方是$Hz$

<span style="color:orange">注意：</span>当没有给信噪比的条件就只能使用奈氏准则，而如果当给出了信噪比与码元种数时，就需要同时使用奈氏准则与香农定理，然后取较小值作为答案。

### 编码

把数据变换为模拟信号的过程称为**调制**，把数据变换为数字信号的过程称为**编码**

#### 数字数据==编码==为数字信号

数字数据通过数字发送器转换为数字信号。

编码方式：

![image-20230726200226166](https://trouvaille-oss.oss-cn-beijing.aliyuncs.com/picList/202307262002268.png)

1. 归零编码$RZ$

    +   ==折$1$平$0$==
    +   信号电平在一个码元内都要恢复到$0$
    +   信道使用率低，基本上都是无使用。

2. 非归零编码$NRZ$

    +   ==高$1$低$0$==
    +   非常容易实现
    +   但是没有检错功能，却无法判断一个码元的开始与结束从而很难保持收发双方的同步。
        +   无法传递时钟信号，双方难以同步
        +   因此若想传输高速同步数据， 则需要都带有时钟线

3. 反向非归零编码$NRZI$

    +   ==折$0$平$1$==
        +   信号电平翻转表示$0$，不变表示$1$。
        +   翻转的信号本身可以作为一种通知机制，能传输时钟信号
    +   对于全$1$的数据同步效果不好。
    +   ==$USB 2.0$通信的编码方式就是$NRZI$编码==

4. 曼彻斯特编码。

    +   ==同$0$异$1$==
        +   即下一个频率电平变化则代表下一位为$1$，不变化则为$0$
    +   每一个码元中间都会产生电平调变，所以中间的跳变既可以作为时钟信号用于同步，也可以用于数据信号
    +   ==但是其占有的频带宽度是原基带宽度的两倍==
    +   因为每一个码元被调制为两个电平，所以数据传输速率只有调制速率的一半。
    +   ==以太网使用的编码方式就是曼彻斯特编码==

5. 差分曼彻斯特编码。

    +   ==同$1$异$0$==
        +   若码元为$1$，则前半段与上一个码元的后半个码元电平相同
        +   若为$0$则相反
    +   每个码元中间同样有电平跳变可用于同步
        +   可以实现自同步
        +   抗干扰性也强于曼彻斯特编码。

6. $4B/5B$编码

    +   $4$位码转换为$5$位码，比特流中插入额外的比特来打断一连串的$0$或$1$，编码效率为$80\%$

    +   只采用$16$种对应$16$种不同的位码，其他$16$种作为控制码，控制帧开始与结束以及线路状态等或保留。

    +   | 十进制数 | 4位二进制数 | 4B/5B编码 | 十进制数 | 4位二进制数 | 4B/5B编码 |
        | :------: | :---------: | :-------: | :------: | :---------: | :-------: |
        |    0     |    0000     |   11110   |    8     |    1000     |   10010   |
        |    1     |    0001     |   01001   |    9     |    1001     |   10011   |
        |    2     |    0010     |   10100   |    10    |    1010     |   10110   |
        |    3     |    0011     |   10101   |    11    |    1011     |   10111   |
        |    4     |    0100     |   01010   |    12    |    1100     |   11010   |
        |    5     |    0101     |   01011   |    13    |    1101     |   11011   |
        |    6     |    0110     |   01110   |    14    |    1110     |   11100   |
        |    7     |    0111     |   01111   |    15    |    1111     |   11101   |

#### 模拟数据到数字信号

因为计算机内部都是二进制数据，如处理的是数字音频，所以需要将模拟声音通过采样、量化转换位有限个数字表示的离散序列，这就是音频数字化。

1. 抽样：对模拟信号周期性扫描，把时间上连续的信号变为时间上的离散信号
    +   采样频率遵循采样定理
        +   当采样的频率大于或等于模拟数据的频带带宽（最高变化频率）的两倍时， 所得的离散信号可以无失真地代表被采样的模拟数据
        +   即采样频率$\geqslant2$信号最高频率。
2. 量化：把抽样取得的电平幅值按照一定的分级标度转换位对应的数字值并取整，于是连续的电平幅值就变为离散的数字量。
3. 编码：把量化结果转换为与之对应的二进制编码。

音频信号模拟数据通过$PCM$（脉冲编码调制）编码器转换为数字信号。

采样和量化的实质就是分割和转换

### 调制

即将数据转换为模拟信号。

同时在接收端解调模拟信号转为数字信号。

#### 数字数据==调制==为模拟信号

数字数据通过调制器转换为模拟信号。

![数字数据到模拟信号](https://trouvaille-oss.oss-cn-beijing.aliyuncs.com/picList/202307261208852.png)

1. 幅移键控（调幅$ASK$）

    +   通过改变载波信号的振幅来表示数字信号$1$和$0$，而载波的频率和相位都不改变
    +   比较容易实现
    +   但抗干扰能力差。

2. 频移键控（调频$FSK$）

    +   通过改变载波信号的频率来表示数字信号$1$和$0$，而载波的振幅和相位都不改变
    +   容易实现，抗干扰能力强，目前应用较为广泛。

3. 相移键控（调相$PSK$）

    +   通过改变载波信号的相位来表示数字信号$1$和$0$，而载波的振幅和频率都不改变
    +   它又分为绝对调相和相对调相。

4. 正交振幅调制（$QAM$）

    +   在频率相同的前提下，将$ASK$与$PSK$结合起来，形成叠加信号

    +   设波特率为$B$，采用$m$个相位，每个相位有$n$种振幅，码元类型=相位数×振幅数

    +   则该$QAM$技术的数据传输速率$R$为
        $$
        R=B\log_2(mn)
        $$
        即为波特率×$\log_2\,$(相位数×每相位振幅数)。

#### 模拟数据到模拟信号

+   为了实现传输的有效性，可能需要较高的频率
    +   这种调制方式还可以使用频分复用$FDM$技术，充分利用带宽资源
    +   电话机和本地局交换机采用模拟信号传输模拟数据的编码方式，模拟的声音数据是加载到模拟的载波信号中传输的
+   模拟数据通过放大调制器转换为模拟信号。
    +   将低频信号调制为高频信号。

### 电路交换、报文交换与分组交换

#### 电路交换

1. 建立连接（电路建立）。
2. 通信。
3. 释放连接（拆除电路）。

链路支持多路复用（可参考数据链路层的$TDM$等）。

从通信资源的分配角度来看，“交换”就是按照某种方式动态地分配传输线路的资源。电路交换的关键点是，在数据传输的过程中，用户始终占用==端到端==的固定传输带宽。 

电路建立后，除源结点和目的结点外，电路上的任何结点都采取“直通方式”接收数据和发送数据，即==不会存在存储转发所耗费的时间==

优点：

1. 通信时延小，速度快。
    +   由于通信线路为通信双方用户专用，数据直达，因此传输数据的时延非常小
    +   当传输的数据量较大时，这一优点非常明显。
2. 有序传输。
    +   双方通信时按发送顺序传送数据，不存在失序问题。
3. 无冲突争用。
    +   不同的通信双方拥有不同的信道，不会出现争用物理信道的问题
4. 适用范围广
    +   电路交换既适用于传输模拟信号，又适用于传输数字信号。
5. 实时性强。
    +   通信双方之间的物理通路一旦建立，双方就可以随时通信。
6.  控制简单
    +   电路交换的交换设备（交换机等）及控制均较简单

缺点：

1. 建立连接时间长。
2. 线路独占，使用效率低。
3. 灵活性较差。
    +   只要在通信双方建立的通路中的任何一点出了故障，就必须重新拨号建立新的连接，这对十分紧急和重要的通信是很不利的。
4. 难以规格化
    +   电路交换时，数据直达，不同类型、不同规格、不同速率的终端很难相互进行通信
5. 不能流量控制。
6. 无差错控制能力。

#### 报文交换

报文：源应用发送的信息整体。

报文交换在交换结点采用的是==存储转发==的传输方式。 

1. 源先根据报文加上IP地址，物理地址等，通过物理层发送。
2. 交换机收到报文之后，先进行存储，等待链路空闲之后进行转发，但是转发的路径不是固定的，是比较随机的。
3. 最后通过许多交换机最终到达目的地。

优点：

1. 无需建立连接。
    +   报文交换不需要为通信双方预先建立一条专用的通信线路，不存在建立连接时延，用户可以随时发送报文。
2. 存储转发，动态分配线路。
    +   当发送方把报文交给交换设备时，交换设备先存储整个报文，然后选择一条合适的空闲线路，将报文发送出去。
3. 线路可靠性高。
    +   如果某条传输路径发生故障，那么可重新选择另一条路径传输数据， 因此提高了传输的可靠性
4. 线路利用率较高。
    +   通信双方不是固定占有一条通信线路，而是在不同的时间一段一段地部分占有这条物理通道，因而大大提高了通信线路的利用率。
5. 多目标服务。
    +   一个报文可以同时发送给多个目的地址，这在电路交换中是很难实现的

缺点：

1. 有存储转发时延。
    +   数据进入交换结点后要经历存储、转发这一过程，
2. 报文大小不定，需要网络结点有较大的缓存空间。

所以报文交换不能应用于实时通讯，如电话，视频。

报文交换==主要使用在早期的电报通信网中，现在较少使用，通常被较先进的分组交换方式所取代==

#### 分组交换

将大的数据块分割为小的数据块。分组交换和报文交换基本相同，就是将报文切割之后再进行发送。

==现在的主流网络基本上都可视为分组交换网络。==

优点：

1. 无需建立连接。
    +   不需要为通信双方预先建立一条专用的通信线路，不存在建立连接时延，用户可以随时发送报文。
2. 存储转发，动态分配线路。
    +   当发送方把报文交给交换设备时，交换设备先存储整个报文，然后选择一条合适的空闲线路，将报文发送出去。
3. 线路可靠性高。
4. 线路利用率较高。
5. 相较于报文交换，简化了存储管理：分组大小一定，存储管理更容易。
    +   因为分组的长度固定，相应的缓冲区的大小也固定， 在交换结点中存储器的管理通常被简化为对缓冲区的管理，相对比较容易
6. 分组更小，所以传输时延比报文交换的更小。
    +   分组是逐个传输的，可以使后一个分组的存储操作与前一个分组的转发操作并行，这种流水线方式减少了报文的传输时间
    +   此外，传输一个分组所需的缓冲区比传输一次报文所需的缓冲区小得多，这样因缓冲区不足而等待发送的概率及时间也必然少得多
7. 减少了出错概率和重发数据量
    +   因为分组较短，其出错概率必然减小，所以每次重发的数据量也就大大减少，这样不仅提高了可靠性，也减少了传输时延

缺点：

1. 有存储转发时延。
    +   尽管分组交换比报文交换的传输时延少，但相对于电路交换仍存在存储转发时延
    +   而且其结点交换机必须具有更强的处理能力
2. 需要传输额外的信息量（编号、目的地址等）。
    +   一定程度上降低了通信效率， 增加了处理的时间，使控制复杂，时延增加。
3. 乱序到达目的主机时，需要对分组进行排序。
    +   若采用虚电路服务，虽无失序问题,但有呼叫建立、数据传输和虚电路释放三个过程

---

>   1. 报文交换和分组交换都采用存储转发。
>   2. 传输数据量大且传输时间远大于呼叫时间，就选择电路交换，其传输时延最小。
>   3. 报文交换分组交换在信道利用率上优于电路交换。

![数据交换](https://trouvaille-oss.oss-cn-beijing.aliyuncs.com/picList/202307251139568.png)

### 分组交换传输方式

数据报和分组的关系：分组是一段比较长的数据，将它进行切割成一段段之后就得到数据报。其都是网络层的传输单位。

分组交换分为数据报方式和虚电路方式两种。

对于出错率高的线路应该使用数据报方式。

#### 数据报方式

作为通信子网用户的端系统发送一个报文时，在端系统中实现的高层协议先把报文拆成若干带有序号的数据单元，并在网络层加上地址等控制信息后形成数据报分组（即网络层的PDU）中间结点存储分组很短一段时间，找到最佳的路由后，尽快转发每个分组

用图2.5的例子来说明数据报服务的原理。假定主机A要向主机B发送分组：

![image-20230726202145781](https://trouvaille-oss.oss-cn-beijing.aliyuncs.com/picList/202307262021860.png)

1.   主机$A$先将分组逐个发往与它直接相连的交换结点$A$,交换结点$A$缓存收到的分组。
2.   然后查找自己的转发表。由于不同时刻的网络状态不同，因此转发表的内容可能不完全相同,所以有的分组转发给交换结点$C$，有的分组转发给交换结点$D$。
     +   路由器根据分组的目的地址转发组
         +   基于路由协议/算法构建转发表（目的网络地址与链路接口的散列对）
         +   检索转发表
         +   每个分组独立选路
3.   网络中的其他结点收到分组后，类似地转发分组，直到分组最终到达主机$B$。 

可以总结出数据报服务具有如下特点：

+ 提供无连接服务，可随时发送和接受。
+ ==尽最大可能交付，所以不保证可靠性。==
+ 不事先为分组的传输确定传输路径，每个分组独立确定传输路径，==不同分组传输路径可能不同，也不一定按序到达。==
+ 每个分组携带源和目的地址，以便可以独立传输
+ 分组在交换结点存储转发时需要排队等待，这会带来一定的时延
+ 通过交换结点的通信量较大或网络发生拥塞时，这种时延会大大增加，交换结点还可根据情况丢弃部分分组
+ 可及时更新转发表，适应性强。
    + 网络具有冗余路径，当某个交换结点或一条链路出现故障时，可相应地更新转发表，寻找另一条路径转发分组，对故障的适应能力强。

+ 存储转发的延时一般较小，提高了网络的吞吐量。
+ 收发双方不单独占用信道，资源利用率高。

#### 虚电路方式

+ 虚电路将数据报方式与电路交换方式结合。
+ 虚电路是一条源主机到目的主机类似电路的逻辑连接，路径上所有结点都要维持该虚电路的建立，都维持一张虚电路表，每一项都记录一个打开的虚电路的信息。
+ 虚电路方式提供连接服务，首先为分组的传输确定传输路径，然后沿该路径/连接传输系列分组，分组的传输路径相同，结束后拆除连接。
+ 一条物理链路可能有多个逻辑电路。
+ 虚拟电路包含临时和永久两种：
    + 永久性虚电路$PVC$：是一种提前定义好的、基本上不需要任何建立时间的端点之间的连接。
    + 交换型虚电路$SVC$：是端点之间的一种临时性连接，这些连接只持续所需的时间，并且在会话结束时就取消这种连接，B错误。

传输过程：

1. 建立虚电路连接：
    +   主机$A$与主机$B$之间先建立一条逻辑通路，主机$A$发出一个特殊的“呼叫请求”分组，该分组通过中间结点送往主机$B$,若主机$B$同意连接，则发送“呼叫应答”分组予以确认
    +   每个分组携带虚电路标识$VCID$，而非目的地址，源主机发送呼叫请求分组并收到呼叫应答分组后才算建立连接。
2. 数据传输：全双工通信。
3. 释放虚电路连接：源主机发送释放请求分组以拆除虚电路。
    +   传送结束后主机$A$通过发送“释放请求”分组来拆除虚电路，逐段断开整个连接

![image-20230726203303775](https://trouvaille-oss.oss-cn-beijing.aliyuncs.com/picList/202307262033891.png)

>   图`2.6`所示的数据传输过程是有确认的传输（由高层实现），主机$B$收到分组后要发回相应分组的确认。网络中的传输是否有确认与网络层提供的两种服务没有任何关系

特点：

+ 虚电路通信链路建立拆除需要时间，==不适合交互式和小量短分组，适合长时间频繁数据交换==。
+ 虚电路的**路由选择**体现在连接建立阶段，连接建立后，就确定了传输路径
+ 可靠通信，保证有序到达。
+ 提供流量控制，当接收方来不及接收数据时，可以通知发送方暂缓发送。
+ 虚电路有一个致命的弱点：即当网络中的某个结点或某条链路出现故障而彻底失效时， 所有经过该结点或该链路的虚电路将遭到破坏。
+ 分组首部不包含目的地址，包含虚电路标识符，开销小。

|       &nbsp;       |           数据报服务           |                     虚电路服务                     |
| :----------------: | :----------------------------: | :------------------------------------------------: |
|      建立连接      |              不用              |                        必须                        |
|      目的地址      |  每个分组都要有完成的目的地址  | 仅在建立连接时使用，之后每个分组使用较短的虚电路号 |
|      路由选择      | 每个分组单独进行路由选择与转发 |      属于同一条虚电路的分组按照同一个路由转发      |
|      分组顺序      |         不保证有序到达         |                    保证有序到达                    |
|       可靠性       | 不保证，可靠性依靠用户主机保证 |                        保证                        |
|   网络故障适应性   |               强               |                         弱                         |
| 差错控制和流量控制 |          用户主机完成          |          可由网络完成也可以由用户主机完成          |

## 传输媒介

是数据传输系统种在发射设备与接受设备之间的物理通路（信道是逻辑通路）。

传输媒体并不是物理层。

+ 导向性传输介质：电磁波沿着固体媒介（铜线或光纤）被导向传播。
+ 非导向性传输介质：自由空间，如空气，水等等。

### 导向型传输介质

#### 双绞线

+ 是两根采用规则并排校合并绝缘的铜导线组成。绞合是减少电磁干扰。
+ 根据有无屏蔽层分为屏蔽双绞线（$STP$）和无屏蔽双绞线（$UTP$）。$UTP$外加上金属网就是$STP$。
+ 通信距离为几到数十公里。
+ 距离太远需要使用放大器放大模拟信号，中继器整形数字信号。

#### 同轴电缆

同轴电缆由内导体、绝缘层、网状编织屏蔽层和塑料外层构成。

+ $50\Omega$：基带同轴电缆。用于局域网。
+ $75\Omega$：宽带同轴电缆。用于有线电视系统。

由于外导体屏蔽层的作用，同轴电缆较双绞线具有良好的抗干扰特性，被广泛用于传输较高速率的数据，其传输距离更远，但价格较双绞线贵。

#### 光纤

+ 传递光脉冲，带宽大于其他传输媒体。
+ 实心纤芯与包层构成。
+ 分为多模光纤与单模光纤。

|   定义   |                光源                |         特点         |          外观          |
| :------: | :--------------------------------: | :------------------: | :--------------------: |
| 单模光纤 | 一种在横向模式直接传输光信号的管线 | 定向性好的激光二极管 | 损耗小，适合远距离传输 |
| 多模光纤 |     有多种传输光信号模式的光纤     |    普通发光二极管    | 易失真，适合近距离传输 |

光纤特点：

1. 传输损耗小，中继距离长。
2. 抗雷电电磁干扰性能好。
3. 保密性好，无串音干扰。
4. 体积小重量低。

### 非导向性传输介质

+ 无线电波：
    + 全方向传播；
    + 穿透率较强；
    + 可远距离通信，主要用于电话通信。
+ 微波：
    + 固定方向传播；
    + 频率高、频段广、数据率高；
    + 分为地面微波接力通信与卫星通信；
        + 卫星通信的优点：通信容量大、距离远、覆盖光、广播通信与多址通信；
        + 卫星通信的缺点：传播时延长、受天气干扰大、误码率高、成本高。
+ 红外线与激光：
    + 固定方向传播；
    + 需要转换为各自的信号格式再在空间中传播。

### 物理层接口特性

+ 机械特性：规格、接口形状、引线数目、引脚数量、排列情况。
+ 电气特性：电压范围、阻抗匹配、传输速率、距离限制。
+ 功能特性：电平意义、接口部件的用途。
+ 规程特性（过程特性）：工作规程和时序的关系。

## 物理层设备

网段在物理层互联时要求数据传输速率相同，但是上层协议可以不同。

### 中继器（RP、repeater）

也称为转发器，仅作用于信号电气部分，用于对数字信号进行再生和还原，对衰减的信号进行整形、放大（不仅仅是放大）。

中继器的两端：

+ 网段而非子网。使用中继器连接的几个网段仍然是一个局域网。
+ 类型相同。
+ 网络速度相同。
+ 只负责发送而不关心是否有问题。
+ 可以连不同媒体也可以连相同媒体。
+ 不会存储转发所以一定要协议相同。
+ $5-4-3$规则：采用粗同轴电缆的$10BASE5$以太网规范，$5$是指不能超过五个网段；$4$是指在这些网段中的物理层网络设备（中继器，集线器）最多不超过四个；$3$是指这些网段中最多只有三个网段挂有计算机。

<span style="color:orange">注意：</span>若网络设备具有存储转发的功能则能连接不同的协议，否则则不能。

<span style="color:orange">注意：</span>放大器和中继器都起放大作用，只不过放大器放大的是模拟信号，原理是将衰减的信号放大，而中继器放大的是数字信号，原理是将衰减的信号整形再生。

### 集线器（Hub）

集线器是多口中继器，功能类似，放大信号再转发到其他所有除输入端口外处于工作态的端口上。

+ 不具备信号的定向传送能力，是一个共享式设备（广播）。
+ 因为是广播所以有大的冲突域，不能分割冲突域。所以多少个计算机连入集线器，同时工作时就平分集线器拥有的带宽。
+ 同时只能有两个设备进行通讯，只会传输信号。
+ 只能在半双工状态下工作。
+ 集线器连接的网络拓扑结构上属于星型。
+ 当集线器的一个端口收到数据后立刻从除输入端口外的所有端口广播出去。

以太网上的集线器默认是$100Base-T$，即传输速率为$100Mb/s$。
