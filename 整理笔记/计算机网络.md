# 计算机网络

+ $\mathrm{OSI}$参考模型
  + **物理层**：解决使用**何种比特**来解决传输的问题（如何选物流车）、传输单位是比特。
  + **数据链路层**：解决分层在**一个网络或一段链路上**传输的问题（如何运输）、范围是相邻两个节点、传输单位是帧。
  + **网络层**：解决分组在多个网络上**传输/路由**的问题（如何分拣）、传输单位是$IP$数据报或分组、范围是整个网络或两个主机。
  + **传输层**：解决进程之间（**端到端**）基于网络的通信问题（如何派件）、传输单位是报文或报文段、范围是两个用户进程之间。
  + **会话层**：负责管理主机间的**会话**进程，包括建立、管理及终止进程间的会话。
  + **表示层**：主要处理在两个通信系统中**交换信息的表示方式**。
  + **应用层**：解决通过应用进程的交互来实现特定网络应用的问题（如何售后）。
+ 各层的服务访问点$SAP$：数据链路层【以太网帧的**类型**字段】、网络层【IP数据报的**协议**字段】、传输层【端口】、应用层【用户界面】。
+ $\mathrm{OSI}$模型中，下层为上一层提供服务。
+ **传输媒体不属于物理层，传输媒体和物理层放一起就是错的**。
+ $\mathrm{TCP/IP}$参考模型：先有协议栈才有参考模型、常考**传输层**看清楚是哪个模型。

  - 网络接口层：作用是从主机或结点接收$IP$分组，并把它们发送到指定的物理网络上。对应$OSI$参考模型中的物理层和数据链路层。
  - 网际层：将分组发往任何网络，并为之独立地选择合适的路由，但它不保证各个分组有序地到达，各个分组的有序交付由高层负责。网际层定义了标准的分组格式和协议，即$IP$和$IP$协议。支持主机到主机的通信。
  - 传输层：和$\mathrm{OSI}$参考模型中的传输层类似，即使得发送端和目的端主机上的对等实体进行会话。支持应用到应用的通信或进程到进程的通信。
  - 应用层：对应$\mathrm{OSI}$参考模型中的会话层、 表示层和应用层。
+ 两个模型的差异

  - $OSI$在网络层支持无连接和面向连接的通信，但在传输层仅有面向连接的通信（不是TCP，定模型的时候也没有UDP）;
  - $TCP/IP$模型认为可靠性是端到端的问题，因此它在网际层仅有一种无连接的通信模式， 但传输层支持无连接和面向连接两种模式。
+ 【奈式准则】：①$\begin{align}
  \left\{\begin{matrix} 
    &B  = 2W\\  
    &R  = 2W\log_2V\\
  &R=B\times\log_2V
  \end{matrix}\right. 
  \end{align}$，其中$B$表示理想低通信道下的极限波特率、$R$表示理想低通信道下的极限比特率，奈式准则限定的是码元的传输速率$B$；②奈式准则意义是，在任何信道中，波特率是有上限的，超过该上限就会出现码间串扰（**悲观**）；③应对方法是使每个码元能携带更多的个比特量的信息。
+ 【香农定理】：①$R=Wlog_2{(1+S/N)}$，其中$S/N$表示$\frac{S}{N}$纯数值无单位、可使用$\mathrm{SNR}=10\cdot\log_{10}{\frac{S}{N}}$转化；②香农定理的意义在于，只要**信息传输速率/比特率**低于信道的极限传输速率，就**一定能**找到某种方法来实现无差错的传输（**乐观**）；③信噪比越大（信号越强）、**信息传输速率越小（传输每个码元的时间越长）**，数据的抗噪能力越强，判决错误的概率越小；④**有噪声的信道只能是香农定理**。
+ 【$\mathrm{CSMA/CD}$协议】：①边发送数据边**检测碰撞**，适用于半双工网络；②在$2\mathrm{RTT}$时间内没有检测到碰撞，那么就可以肯定本次发送没有碰撞；③截断二进制指数规避算法：$n\times 2\tau $，其中$n$为$0$到$2^{k-1}$，$k$不超过$10$，最多$16$次超过就丢弃；④以太网规定争用期为$51.2\mathrm{\mu s}$，最短帧长为$64\mathrm{B}=512\mathrm{bit}$，凡是小于则被判定为无效帧。
+ 【停止等待协议$\mathrm{SR}$】：①相当于发送窗口和接收窗口大小均为`1`的滑动窗口协议，只需要一位帧编号，**数据帧与确认帧必须编号**；②发送一个帧直到对方确认前均不会再发送；③发送方和接收方均设置一个帧缓冲区用于必须保存副本以便重传。
+ 【后退$N$帧协议$\mathrm{GBN}$】：①**仅$\mathrm{GBN}$是累计确认**；②同时采用捎带确认，**确认报文在下一个数据帧上**；③由于接收窗口仅为一，故接收方只**按顺序**接受帧，除此以外的帧会被丢弃；④重传时必须**把原来已经正确传送的数据帧再次传输一次**；⑤信道利用率较高，但当信道的传输质量很差时会导致误码率较大，不一定优于$\mathrm{SW}$。
+ 【选择重传协议$\mathrm{SR}$】：①由于接收窗口大于一，故不管是否按序都能接受传过来的帧（**不采用累计确认**，来一个确认一个），且仅$\mathrm{SR}$的接收方有缓存；②只会重传出错帧。
+ 【集线器$\mathrm{Hub}$】：①网络**拓扑结构上属于星型**，**逻辑上属于总线型**；②相当于多端口的**中继器**；③只能在**半双工状态**下工作；④以太网上的集线器默认是$100\mathrm{BaseT}$，即传输速率为$100\mathrm{Mbps}$；⑤无法分割广播域和冲突域、不能连接两个具有不同速率的局域网。
  + 中继器/转发器的实现原理是信号再生，而非简单地将衰减的信号放大；
  + 采用粗同轴电缆的$10\mathrm{BASE}5$以太网$5-4-3$规则：$5$是指不能超过五个**网段**、$4$是指在这些网段中的物理层网络设备（中继器，集线器）最多不超过四个、$3$是指这些网段中最多只有三个网段挂有计算机；
+ 【以太网交换机】：①相当于多端口的网桥，可互联不同物理层、不同$MAC$子层和不同速率的以太网，且仅适用于少数据量的局域网，否则会**出现广播风暴**；②总带宽是各端口带宽之和即总容量会变为原来的$N$倍；③一般工作在**全双工方式**；④可以隔离碰撞域/冲突域，**不能隔离广播域**、可以连接两个具有不同速率的局域网（**需要存储转发**）。
  + 若单接口速率为$a$，半双工情况下带宽为$a$，总容量为$\frac{1}{2}aN  $；全双工情况下带宽为$2a$，总容量为$aN  $。
+ 【路由器】：①可以**抑制**网络上的广播风暴；②由路由选择和分组转发两部分构成，其中交换结构可以通过通过**存储器、总线和互联网络**进行交换，**不进行差错检测**；③路由器是面向协议的，而低级设备（网桥、交换机等）都与高层协议无关；④一般默认网关地址就是**离主机最近路由器**的$LAN$端口地址；
  + 【路由器无法处理上层数据】：路由器要求物理层、数据链路层、网络层协议可以不同，但网络层以上的高层协议必须相同。
  + ※※**路由器每个接口都需要分别配置$\mathrm{IP}$地址**，尤其在$\mathrm{IP}$分配题中需要特别注意；
  + 【特定路由】：互联网默认路由$0.0.0.0/0$、特定目的主机专门制定的路由指定子网掩码为$32$；
+ $\mathrm{VLAN}$等价于广播域，网段等价于冲突域。
+ 【$\mathrm{IP}$分组的转发过程】：①检查校验和字段，出错直接丢弃（不会发送差错报文）；②根据目的$\mathrm{IP}$地址查找路由表，采用**最长前缀匹配法**确定下一跳，找不到直接丢弃并发送$\mathrm{ICMP}$目的不可达差错报文；③更新$\mathrm{IP}$首部，更新$\mathrm{TTL}$和检验和，如果是$\mathrm{NAT}$路由器还需要更新$\mathrm{IP}$地址等。
  + 差错报文主要用于报告如目的不可达、超时等**网络层逻辑问题**，而不是物理层或链路层的传输问题（如校验和错误）。
+ 【分组与排序】：$\mathrm{IP}$数据报**在网络层进行分片和重组**、在**传输层中**依靠序号字段**进行排序工作**。
+ 【$\mathrm{ARP}$协议的通信过程】：①检查$\mathrm{ARP}$高速缓存，如果有对应项就直接写入$\mathrm{MAC}$帧并结束；②用`FF-FF-FF-FF-FF-FF`作为目的$\mathrm{MAC}$地址，并广播**$\mathrm{ARP}$请求分组**；③目的主机收到请求后会向源主机**单播$\mathrm{ARP}$响应分组**，源主机收到后将该映射写入$\mathrm{ARP}$缓存中。
  + $\mathrm{ARP}$请求报文直接封装在以太网广播帧中、使用广播 $\mathrm{MAC}$地址全一；**$\mathrm{ARP}$响应分组封装在以太网单播帧中**、 **$\mathrm{MAC}$地址不为全一**。
  + $\mathrm{ARP}$工作在网络层（能看到$\mathrm{IP}$地址）、$\mathrm{NAT}$工作在传输层（能获取端口）。
+ 【子网划分】：可用子网数量不用减二、可分配主机数量应该减二。
+ $RIP$是应用层协议，使用$UDP$；$OSPF$是网络层协议，直接用$IP$数据报传送；$BGP$是应用层协议，使用$TCP$。
+ 【路由信息协议$\mathrm{RIP}$】：基于**距离-向量路由算法**、一条路径最多只能包含$15$个路由器（$16$表示网络不可达）、慢收敛是导致发生**路由回路**的根本原因、一个$RIP$报文最多只包含$25$个路由。
+ 【解决慢收敛方法】：①抑制计时器法；②毒性逆转，将度量值变为无穷大的数，然后将其中毒的路由信息发布出去；③触发刷新，检测到网络故障的路由器会直接发送一个更新信息给邻居路由器，并依次产生触发更新通知它们的邻居路由器（**能使全部路由器在最短的时间内收到更新信息**）；④分割水平线；⑤限制路径最大距离。
+ 【开放最短路径优先协议$\mathrm{OSPF}$】：使用**洪泛法**向所有相邻的路由器发送信息（不再发送给刚刚发来信息的那个路由器）、**链路状态报文大小与网络中的路由结点数目无关**（链路状态算法比距离-向量算法有更好的规模可伸展性）。
+ 【边界网关协议$\mathrm{BGP}$报文】：使用$\mathrm{KEEPALIVE}$作为$\mathrm{OPEN}$的确认。
+ **本机的$DNS$地址即为本地域名服务器**。
+ 【$\mathrm{HTTP}$】：访问的Web网页附有k个小文件，小文件大小均为一个$\mathrm{MSL}$，则
  - 首先先看清楚是从点击开始、从发送请求开始、从连接建立开始；
  - 三种情况共有：建立$\mathrm{TCp}$链接时前两次握手正常，第三次主机向服务器发送确认握手时会附带第一次对于Web网页的请求，服务器会在稍后发送确认时捎带Web网页，总高耗时`2RTT`。
  - **非持续非流水线、$\mathrm{HTTP}$/1.0**：每传输一个Web页面或者小文件都需要重新建立一次$\mathrm{TCP}$链接，第三次握手可以附带$\mathrm{HTTP}$请求。**每一个Web页面和小文件都需要至少两个RTT**。
  - **持久连接非流水线、$\mathrm{HTTP}$/1.1**：客户在收到前一个响应后才能发出下一个请求；
  - **※持久连接流水线、$\mathrm{HTTP}$/1.1默认**：默认$\mathrm{TCP}$链接的第三个报文携带$\mathrm{HTTP}$请求报文，之后发送的数据长度依照慢开始（假设理想条件没有重传和拥塞）算法进行传输。
+ 【**※※※并行$\mathrm{TCP}$连接**】：几个小图像就是几个并行的$\mathrm{TCP}$连接。即若采用并行$\mathrm{TCP}$连接，使用非持续非流水线链接传输时，只需要$4RTT$其中前两个$\mathrm{RTT}$用于前两次握手，第三次链接使用并行$\mathrm{TCP}$连接一次性全部传输完成。
+ 【$\mathrm{HTTP}$】：①实体主体部分可以为空，例如$\mathrm{404}$和$\mathrm{HEAD}$请求；②一个请求报文对应一个响应报文；③一个$\mathrm{TCP}$报文只能封装一个$\mathrm{HTTP}$请求报文。
+ 【点对点协议$\mathrm{PPP}$】：①**不可靠，提供差错检测但不提供纠错功能、不使用序号和确认机制**；②仅支持点对点的链路通信，不支持多点线路；③只支持全双工链路；④两端可以运行不同的网络层协议；⑤面向字节；⑥**异步传输时使用字节填充法**，**同步传输链路时采用零比特填充法**。
+ 【$\mathrm{PPP}$帧】：无须采用$CSMA/CD$协议（不是总线形、同时没有最短帧），有效信息最小值为$0\mathrm{B}$而非通常的$46\mathrm{B}$。
+ 【高速以太网（快速以太网）】：速率大于$100\mathrm{Mbps}$的以太网。**半双工时使用$CSMA/CD$协议**、采用保持最短帧长不变而将最大电缆长度减少到$100m$的方法。
  + 【$100\mathrm{BaseT}$以太网】：使用双绞线、星型拓扑、全双工方式工作下无冲突；
  + 【吉比特以太网】：使用光纤或双绞线；
  + 【$10$吉比特以太网】：使用光纤、只支持全双工故不使用$CSMA/CD$协议。
+ 【移动$\mathrm{IP}$】：固定主机$B$向移动主机$A$发送$\mathrm{IP}$数据报，则该数据报的源$\mathrm{IP}$地址为主机$B $的$\mathrm{IP}$地址，目的$\mathrm{IP}$地址为移动主机$A $的永久$\mathrm{IP}$地址，归属代理收到该$\mathrm{IP}$数据报后，会将目的$\mathrm{IP}$地址改变为外地代理的转交地址。
+ 【$\mathrm{DHCP}$】：①有发现报文、提供报文、请求报文、确认报文四种报文类型②发现报文和请求报文目的$\mathrm{MAC}$地址均为广播地址全一，源$\mathrm{IP}$地址为全零；③$\mathrm{DHCP}$**发现报文**封装在广播$\mathrm{IP}$数据报中，使用广播$\mathrm{IP}$地址全一， 之后封装在以太网广播帧中，使用广播 $\mathrm{MAC}$地址全一；④$\mathrm{DHCP}$相关报文的目的地址均为广播地址（全一），其仅$\mathrm{DHCP}$是这样。
  - 在$\mathrm{DHCP}$执行初期，客户端不知道服务器端的$\mathrm{IP}$地址，而在执行中间，客户端并未被分配$\mathrm{IP}$地址。
+ 【$\mathrm{IEEE 802.11}$无线局域网】：①移动站$A$如果要和另一个基本服务集中的移动站$B$通信，就必须经过两个接入点$AP_1$和$AP_2$，即$A\to AP_1\to AP_2\to B$，其中$AP_1\to AP_2$的通信是使用有线传输的；②**静态路由协议、$\mathrm{RIP}$、$\mathrm{OSPF}$、$\mathrm{BGP}$均不适用于移动自组网络**；③※※※$\mathrm{IEEE 802.11}$的$\mathrm{MAC}$帧格式，**地址一为接受地址、地址二为发送地址**；④发送过程中不需要进行冲突检测，故不使用$\mathrm{CSMA/CD}$协议，而使用$\mathrm{CSMA/CA}$协议。
+ 【虚拟局域网$\mathrm{VLAN}$】：①是一个**广播域**！**广播域**！**广播域**！；②部署在**数据链路层**、通过标识符实现逻辑不需要额外的硬件支持；③可通过交换机端口、网卡$MAC$地址、网络层$IP$子网地址、协议、策略进行划分。
+ 【$IP$多播（组播）】：组播时延远小于多份单播、仅**使用$UDP$不可靠**、组播地址（$D$类地址）只能用于目的地址。
+ 【网际组管理协议$\mathrm{IGMP}$】：①网络层协议；②管理多播组成员关系，确保多播流量只发送到有需求的网络部分；③组成员关系是动态的，需要周期性探询本地局域网上的主机以便确认是否还是多播组成员。
  + 不能知道$IP$组播组包含的成员数，也不知道这些成员分布在哪些网络上；
  + 只能知道本局域网上的组播组成员，并不能在因特网范围内对所有组播组成员进行管理。
+ 【$\mathrm{TCP}$的四种计时器】

  1. 重传计时器（超时计时器）：发送一个报文段时判断该报文段**是否需要超时重传**；
  2. 持续计时器：当发送方收到一个**窗口大小为零的确认**时，为避免双方死锁等待，就启动持续计时器；
  3. 保活计时器：使用保活计时器可**避免服务器在客户机突然出现故障时一直等待**；
  4. 时间等待计时器：在连接释放时使用，为$2\mathrm{MSL}$。
+ 【$\mathrm{BGP}$协议工作原理】：①自治系统的管理员选择至少一个路由器作为$\mathrm{BGP}$发言人；②发言人使用**$\mathrm{TCP}$链接**与其他自治系统中的发言人并交换$\mathrm{Open}$报文以建立$\mathrm{eBGP }$会话（使用$\mathrm{Keepalive }$报文回复$\mathrm{Open}$报文）；③使用$\mathrm{Update }$报文交换路由信息（网络可达性信息）；④发现异常时，发送 $\mathrm{Notification }$报文终止会话。
  + $\mathrm{eBGP }$会话用于不同自治系统之间，$\mathrm{iBGP}$用于同一自治系统之内；
  + $\mathrm{Exterior }$外部的，$\mathrm{Interior }$内部的。
+ 【网络分配向量**$\mathrm{NAV}$**】：在一个自治系统中，主机$A$向$AP$发送数据帧，$B$为自治系统下的一个隐藏栈，由于发送$RTS$帧和返回$CTS$帧均为广播，则需要在发送的帧中填写**该帧占用信道的时间**。

  - $A$向向$AP$广播数据帧前会先广播$RTS$帧，将$\mathrm{NAV=SIFS+CTS+SIFS+DATA+SIFS+ACK}$写入帧头；
  - 当$AP$收到$RTS$帧时会广播一个$CTS$帧，将$\mathrm{NAV=SIFS+DATA+SIFS+ACK}$写入帧头；

![image-20241209231136115](C:\Users\LEGION\AppData\Roaming\Typora\typora-user-images\image-20241209231136115.png)

-----

+ 【使用十六进制列出$\mathrm{IP}$数据报全部内容的大题】：其中$A$、$B$为题中考查的通信双方，且$A$为题上展示$\mathrm{IP}$数据报的那方。
  1. 分析清除每个报文的通信双方，**可能有捣乱的**：①$A$发送的报文一般对方都是$B$，且$A$、$B$的协议字段都应该是$\mathrm{TCP}$；
  1. $\mathrm{SYN}$仅在$\mathrm{TCP}$前两次握手才有效，第三次握手报文可以通过$A$第二次向$B$发送的报文判断；
  1. 握手完毕后，若$B$向$A$发送数据，其首字节编号即为第三次握手时的确认号；
  1. 应用层数据：①$\mathrm{TCP}$数据报头之后的那一串数据均可视为应用层数据，直接算出其长度；②**四挥手第一次挥手**报文的序号减去**三握手第三次握手报文**的序号（需注意第三次握手是否发送了数据）；

- 特殊规定的数值
  - 以太网规定争用期为$51.2\mu s$，以太网最小帧长为$64$字节。
  - IP数据报首部首部长度、总长度、片偏移，基本单位分别为4B、1B、8B。
  - 【熟知端口号】：$FTP$数据连接$20$、$FTP$控制连接$21$、$SMTP=25$、$HTTP=80$、$POP3=110$。
- 【虚电路】：①只是逻辑上的电路，**不需要分配宽带**；②面向连接，可靠传输，**可确保有序到达**；③连接建立时进行路由选择，路由器记录虚电路号$\mathrm{VCID}$与下一跳信息；④传输时依据虚电路号转发（即传**输路径固定**）⑤主要缺点是存在链接建立时间。
- 【数据报】：①无连接，不保证有序，不保证可靠，依靠上层协议实现可靠性，可能丢失或重复；②网络层使用$\mathrm{IP}$协议；③每个报文的**传输路径**均依据路由选择**动态变化**；④到达后需要进行排序去重等。
- ※**总时延=发送时延+传播时延+排队时延+处理时延**。（以下内容暂不考虑排队时延）
  - 电路交换时延：①连接建立时延；②链路传播时延；③发送时延；
  - 分组交换时延：①源节点发送时延；②$n-1$个结点的转发时延（$n$表示链路数），每个结点的转发时延等于分组长度$\div$数据传输速率，即只分别计算一个分组的时延；③链路传播时延；
- 软件定义网络$SDN$

  - 控制平面：**路由选择**，贴近应用，所以在上面，即**对应北向接口**；
  - 数据平面：**分组转发**，贴近**交换机**，所以在下面，即**对应南向接口**。
- 【**流量控制**】

| **控制类型** | **作用范围**                       | **实现方式**                           |
| ------------ | ---------------------------------- | -------------------------------------- |
| 数据链路层   | 点到点，两个相邻节点之间           | 收不下就不回复确认（确认控制帧）       |
| 网络层       | 作用于整个网络                     | 使用**拥塞控制算法**检测拥塞并采取措施 |
| 传输层       | 端到端，作用于两台主机上相应的端口 | 接收端发送拥塞窗口                     |

- 【**以太网传输介质**（以$\mathrm{100BaseT}$为例）】：①速率，单位为$\mathrm{Mbps}$，$100$表示$100\mathrm{Mbps}$，若为$10\mathrm{G}$即表示$10\mathrm{Gbps}$；②$\mathrm{Base}$固定，表示基带传输；③最后的字母表示介质类型，$\mathrm{T}$双绞线$Twisted\, Pair$、$\mathrm{F}$光纤$Fiber$、$\mathrm{5}$粗同轴电缆（500米长所以粗）、$\mathrm{2}$细同轴电缆（200米长所以细）。
- 数字数据调制为模拟信号：调幅$ASK$（振幅$Amplitude$），调频$FSK$（**频率$Frequency$**），调相$PSK$（**相位$Phase$**），正交振幅调制$QAM$。
- 静态划分信道不会发生碰撞。
- 静态划分信道：频分多路复用$FDM$，时分多路复用$TDM$，统计时分复用$ST DM$，波分多路复用$WDM$，码分多路复用$CDM$。
- 码分多路复用$CDM$计算的内积若为零，则表示该站点没有发送数据。
- $CSMA$协议三种监听算法

  - 非坚持和$1-$坚持在空闲时均为直接发送，$p-$坚持和$1-$坚持在忙时均为持续监听。
  - 非坚持：信道忙时会**等待一个随机时间**之后再进行监听，**空闲立刻传输**；
  - $p-$坚持$CSMA$：道忙时会推迟到下一个时隙再监听，信道空闲时以$p$概率直接传输，概率$1-p$等待到下一个时间槽再侦听。
- $CSMA/CA$协议：①可以**避免碰撞**，且可以用于无线局域网即**无线传输**，这是与$CSMA/CD$（检测碰撞、有线传输）最大的区别；②使用交换$RTS$帧和$CTS$帧的方式预约信道。
- $CSMA/CA$协议帧类型：长度依次递增，优先度依次降低

  - $SIFS$（短$IFS$）：最短的$IFS$，用来**分隔对话帧**，使用$SIFS$的帧类型有$ACK$帧、$CTS$帧、分片后的数据帧，以及所有回答$AP$探询的帧等。
  - $PIFS$（点协调$IFS$）：中等长度的$IFS$，在$PCF$操作中使用。
  - $DIFS$（分布式协调$IFS$：最长的$IFS$，用于**发送数据前**。
- 截断二进制指数规避算法：$n\times 2\tau $，其中$n$为$0$到$2^{k-1}$，$k$不超过$10$，最多$16$次超过就丢弃。
- 以太网规定争用期为$51.2\mathrm{\mu s}$，最短帧长为$64\mathrm{B}=512\mathrm{bit}$，凡是小于则被判定为无效帧。
- ICMP报错的【源点抑制】报文：翻译一下就是让【发送方主机（源点）少发点（抑制）】。
- `ping`使用ICMP。
- IP分组在经过路由器分片时会发生变化的字段：①标志字段MF、DF；②片偏移；③总长度；④检验和。
- $\mathrm{IP}$报文分片：①标识$\mathrm{Identification}$，相当于组号、用于标记同属一组的$\mathrm{IP}$报文；②标志$\mathrm{Flag}$，中间位$\mathrm{DF}$表示是否禁止分片、最低位$\mathrm{MF}$表示后面是否还有分片；③片偏移，单位为$8B$；④总长度，单位$1B$、最大为$2^{16}-1B$但会受到$\mathrm{MTU}$的限制；⑤首部长度，单位为$4B$、最小值为$5$（即$\mathrm{IP}$报文最小值为$20B$）；⑥首部检验和、填充，分片时可能变化，填充会把$\mathrm{IP}$报文对齐成四字节的整数倍。
- 【$\mathrm{IP}$报文协议字段】：$\mathrm{ICMP}=1$、$\mathrm{TCP}=6$、$\mathrm{UDP=17}$、$\mathrm{OSPF=89}$。
- IP多播转化为硬件多播时：前25位固定（`01-00-5E`），IP**后23位**映射到MAC地址上，范围为`01-00-5E-00-00-00`~`01-00-5E-7F-FF-FF`，且注意$\mathrm{IP}$表示为十进制、$\mathrm{MAC}$地址为十六进制。
- 网络地址（主机号全为零）既不能作为源地址也不能作为目的地址，`127.xx.xx.xx`既可以作为源地址也能作为目的地址。
- 一般默认TTL最大为64，故两个使用IP通信的站点之间TTL不超过63；RIP最大为16跳，使用RIP的TTL不超过15。
- LSI为OSPF路由协议使用的**路径成本**（由链路的带宽计算得出），需要与RIP协议使用的路由器跳数（**距离**）相区分。
- 当**TTL**减为0时，路由器丢弃该报文并向源主机发送**发送时间超过的ICMP差错报文**。

  - 所以若两个网络之间相隔最少**n**个路由器，数据报的**TTL**至少应为**n + 1**。
- 【路由器找不到匹配的路由项】：丢弃该报文并向源主机发送**目的网络不可达的ICMP差错报文**。
- 【时延带宽积】：①表示传输某数据时链路上**最大比特数量**，等于传播时延$\times$带宽（信道最大数据传输率），单位为`bit`；②
- 若两主机通过WIFI连接，则其对应的路由器为$AP$。
- NAT转换：在两个不同网络下有主机AB，分别由不同的**NAT**路由器$R_A,R_B$管理。当主机A发送IP数据包到主机B时

  1. 主机A发送数据包：源IP地址为主机A的私有IP（**大概率需要分配**），目的IP地址为主机B的**公网IP**。
     + 若主机B为服务器，则该公网IP即为题上所给。
  2. 数据包到达路由器$R_A$：将源IP地址转换为路由器$R_A$转发端口的公共IP。
  3. 传输过程中，路由器继续保持**源IP和目的IP不变**，但**MAC地址会随着数据包经过的路由器进行变化**。
  4. 数据包到达路由器$R_B$：路由器会将目的IP地址转换为路由器$R_B$**内部网络**的IP地址，之后主机B收到数据包。
- IPv6与IPv4的相比：①地址空间扩大，由$32$位变为$128$位；②不需要$DHCP$协议，支持自动配置；③**彻底移除校验和字段**，减少路由器处理时间；④首部长度固定$20B$，废除首部长度字段；⑤使用**拓展首部**取代可选字段；⑥**废除片偏移字段，只允许源主机分片**；⑦废除协议字段、废除总长度字段。
- 若大题中给出具体xx的表结构，则在题中【对xx进行配置】时一定会用到。
- 捎带确认：说明**确认帧帧长等于数据帧长**。
- 【分配$\mathrm{IP}$地址】：①注意路由器端口也需要分配；②在没有要求必须要用完全部地址时，仅需保证每一组的$\mathrm{IP}$地址没有重叠（即不存在一组$\mathrm{IP}$是另一组的前缀即可）即可。
- 【网际控制报文协议$\mathrm{ICMP}$】：作为$\mathrm{IP}$报文的一部分进行传输。
- 【$\mathrm{ICMP}$差错控制报文】：①终点不可达，路由器或主机**不能交付数据报**；②源点抑制，路由器或主机由于**网络拥塞**而丢弃数据报；③改变路由（重定向），由于**存在更好的路由**，路由器改变路由；④时间超过，生存时间$\mathrm{TTL=0}$；⑤分组过大，$\mathrm{IPv6}$超过分片大小。
- 信道利用率：需要乘最大发送窗口，注意捎带确认（没说忽略确认帧就不要忽略）。
- 协议由语法、语义和同步三部分组成

  + 语法：语法规定了通信双方彼此“**如何讲**”，即规定了传输数据的格式；
  + 语义：语义规定了通信双方彼此“**讲什么**”，即规定了所要完成的功能，如需要发出何种控制信息、完成何种动作及**做出何种应答**；
  + 时序/同步：规定执行各种操作的条件、时序关系等，即事件实现**顺序的详细说明**，类似操作系统中的同步操作。
- 【$IEEE802.11$的$MAC$帧格式】：第一个地址为**接受地址**，第二个为**发送地址**。
- 静态介质访问控制不会造成冲突：频分多路复用$FDM$，时分多路复用$TDM$，波分多路复用$WDM$，码分多路复用$CDM$。
- $\mathrm{UDP}$和$\mathrm{TCP}$都有伪首部。
- 【使用$\mathrm{UDP}$的协议】：$\mathrm{DNS}$、$\mathrm{RIP}$、$\mathrm{TFTP}$、$\mathrm{RIP}$、$\mathrm{DHCP}$。
- 【使用$\mathrm{TCP}$的协议】：$\mathrm{HTTP}$、$\mathrm{SMTP}$、$\mathrm{FTP}$、$\mathrm{SSH}$、$\mathrm{BGP}$。
- 【直接使用$\mathrm{IP}$的协议】：$\mathrm{OSPF}$、$\mathrm{ICMP}$、$\mathrm{ping}$。
- UDP首部：以**字节**为单位，最短8B。使用目的端口号实现分用，检验和检测整个UDP数据报是否有错。
- 片偏移：最大数据长度$\times$之前发送的报文数$\div 8B$。
- 【$\mathrm{UDP}$检验和】：①将伪首部、$\mathrm{UDP}$首部和数据部分分为$16$位一组，并将每一组按位相加（相加的过程中**如果最高位有溢出需将溢出位加回低位**，称为回卷）；②对最终获得的结果按位取反即得$\mathrm{UDP}$检验和；③接收方接受时，重新计算以上过程但不取反，和传来的检验和相加为全一即通过。
- $\mathrm{TCP}$面向字节流：$\mathrm{TCP}$从上层接受数据的基本单位是数据块，向上层传递的基本单位是字节流，而TCP将其均视为字节流。
- $\mathrm{TCP}$连接中连续通信中，接受方收到第k个报文段发回的确认报文中的确认号应与第k+1个报文段的序号相等。
- $\mathrm{TCP}$滑动窗口自成一派，即使用的是可变大小的滑动窗口。
- $\mathrm{TCP}$传输时，若在重传倒计时到期前接收到了更大确认号的报文，则不会重传。
- $\mathrm{TCP}$数据报：①为$4B$整数倍，最短为$20B$。

  - 确认号：表示期望收到对方下一个报文段的第一个数据字节的序号；
  - 数据偏移：以$4B$为单位。
- $\mathrm{TCP}$三个标志位：①确认位`ACK`，在连接建立后所有传送的报文段都必须把`ACK`置为$1$，**在除了三握手的第一次握手以外的整个TCP传输中恒有效**；②同步位`SYN`，三握手时有效；③终止位`FIN`，四挥手时有效。
- 【$\mathrm{TCP}$三握手】：①双方均只消耗一个序号，**第三次握手可以不消耗序号**；②三握手全程一半不携带数据，但第三次握手也可以携带数据（例如HTTP的捎带请求），携带数据时需要消耗序号。
- 若$\mathrm{TCP}$建立连接时，即三握手已经完成时，的序号为`seq=a`，且在之后传输了$k$个$MSS$的段后，预发送的序号/对方的确认号即为$a+k\times MSS$。
- 【$\mathrm{TCP}$四挥手中的状态】：①`TIME_WAIT`状态双方共有，但只有主动结束方需要等待`2MSL`；②`FIN_WIAT_1`和`FIN_WIAT_1`均为释放连接发起方独有的状态。
- 【$\mathrm{TCP}$四挥手最短用时】：发起方为$H_{ost}$，接受方为$S_{erver}$。考虑最短用时假设发起时数据已经全部传输完毕，则$\left\{\begin{matrix} 
  T_S=1.5\times RTT \\  
  T_H=RTT+2MSL
  \end{matrix}\right. $。
- $\mathrm{TCP}$拥塞控制中若接受方会对接受到的每一个段进行接受窗口通告，则可以认为**每接受一个段接受窗口就减一**，并非一次传输全部完毕后才减。

  - TCP中第八个段不是第八次传输。
- 对于$\mathrm{TCP}$拥塞控制，发生快重传（接收到连续三个冗余确认帧）时拥塞窗口只降为当前一半，若超时则直接置1，慢开始门限均降为当前一半。
- $\mathrm{B/S}$模型中，**服务器端可在连接建立时主动发送信息**。
- 若从开机开始算起，某主机访问互联网前一定会使用$\mathrm{DHCP}$获取公网$\mathrm{IP}$。
- $\mathrm{DHCP}$用于配置IP地址、子网掩码、DNS等，有**发现报文、提供报文、请求报文、确认报文四种报文类型**。

  - 其中**发现报文和请求报文的目的IP地址和目的MAC地址均为广播地址（全1），源IP地址为全0**。
- $\mathrm{FTP}$服务器端口：数据连接`20`，控制连接`21`。
- 熟知端口：$\mathrm{SMTP}$`25`，$\mathrm{POP}$`101`，$\mathrm{HTTP}$`80`，$\mathrm{SMTP}$`55`。
- 若题上给出了域名，则最多访问次数为【.】个数加一（根域名服务器）。
- 权限域名服务器不是指需要权限，对其进行域名请求时若无法得出最终结果会继续往下查。
- 【广播】：①优点是维护简单成本低廉、服务器流量负载极低（服务器不需要向每个客户机单独发送数据）；②缺点是**广播禁止在$\mathrm{Internet }$ 宽带网上传输**、客户端的最大带宽等于服务总带宽。
- 【组播】：①缺点是没有纠错机制；②优点是具备广播所具备的优点、服务端的服务总带宽不受客户机接入端带宽的限制、允许在$\mathrm{Internet }$宽带网上传输。
- 【文件传送协议$FTP$】：①使用$TCP$、基于$C/S$模型；②控制连接（端口$\mathrm{21}$）在整个会话期间一直保持打开状态，控制信息以七位$ASCII$格式传输；③数据连接只保持一段时间，数据传输完成之后就断开；④主动连接时服务器端数据连接端口号固定是$20$，**被动连接时服务器端端口号不确定**（由两者协商得到）；⑤可以传输$ASCII$和二进制。
- 【简单邮件传送$\mathrm{SMTP}$】：端口$25$，使用$\mathrm{TCP}$、$C/S$模型，只能传输$7$位$ASCII$码。
- 【邮局协议$POP3$】：端口$110$，使用$\mathrm{TCP}$、$C/S$模型，使用明文在传输层上传输密码，不进行加密。
- 数据包的逐层封装

  - 【以$\mathrm{HTTP}$为例】：$\mathrm{HTTP}$报文、$\mathrm{TCP}$报文、$\mathrm{IP}$数据报、$CSMA/CD$报文；
  - 【以$DHCP$为例】：$\mathrm{DHCP}$报文、$\mathrm{UDP}$报文、$\mathrm{IP}$数据报、$CSMA/CD$报文。

---

- 数据报方式和虚电路方式都属于分组交换、报文交换和分组交换都属于存储转发。
- 高速链路，提高的仅是**数据发送速率**而非比特在链路上的传播速率，仅减少数据的发送时延。
- 物理层的接口特性：主要记住均是关于接口、接线器、数据传输的，**不涉及具体的传输介质**。
- 会话层可以使用校验点实现数据同步、表示层可以对数据进行压缩、加密和解密。
- 数字信号的编码：

  + 仅非归零编码**$NRZ$**中间没有跳变，没有检错功能、无法传递时钟信号、需要带有时钟线；
  + 归零编码$RZ$，折一平零；反向非归零编码$NRZI$，折零平一，**$USB 2.0$默认编码**；
  + 曼彻斯特编码，**中间跳变**，以太网默认编码方式（**以太网的波特率是数据率的两倍**）；差分曼彻斯特编码，码元之间跳变。
- 采样定理：模拟数据到数字信号时，采样的频率大于或等于模拟数据的频带带宽的**两倍**时， 所得的离散信号可以无失真地代表被采样的模拟数据。
- 模拟信号调制：调幅$ASK$，**振幅$Amplitude$**；调频$FSK$，**频率$Frequency$**；调相$PSK$，**相位$Phase$**；正交振幅调制$QAM$，见下。
- 正交振幅调制$QAM$：将$ASK$与$PSK$结合起来。若波特率为$B$、采用$m$个相位、每个相位有$n$种振幅，则该$QAM$技术的数据传输速率$R$为$R=B\log_2(nm)$。
- 循环冗余码$CRC$：注意使用的是按位异或、$FCS$的生成与接收端$CRC$检验均由硬件完成；
- **静态划分信道不会发生碰撞**。
- 静态划分信道：频分多路复用$FDM$、时分多路复用$TDM$、统计时分复用$ST DM$、波分多路复用$WDM$、码分多路复用$CDM$。
- 【令牌环网】：①逻辑上是环型的，但是物理上是星型的；②令牌不包含任何信息、使用$TCP$转发；③无视负载，轮流发送数据；④通过修改标志位并附加数据获取令牌并发送数据。
- 【局域网$\mathrm{LAN}$】：①使用广播信道、可以广播与组播、双绞线为主流传输介质；②可以默认所有以太网都符合$IEEE802.3$系列标准规范，逻辑拓扑是总线型，物理拓扑是星型或拓展星型，使用$CSMA/CD$。
- 【以太网/$802.3$局域网】：①**广播**形式发送、使用**曼彻斯特编码**、网络中存在大量的广播信息导致性能降低；②**在使用静态$MAC$地址的系统中，如果有重复的硬件地址，那么这两个设备都不能正常通信**；③以太网适配器上有处理器和存储器，包括$RAM$和$ROM$，$ROM$上有$MAC$地址。
- 【以太网$V2$帧】：①在物理层插入前导码用于时钟同步，包括**前同步码**与**帧开始定界符**两个部分；②校验码采用$32$位循环冗余码$CRC$，但是不用校验$MAC$帧的前导码；③上层数据最短为$46\mathrm{B}$。
- 【广域网】：比局域网大、在下三层均有分布（局域网仅有两层）、用于资源共享。
- 【虚拟专用网$VPN$】：是利用公用的互联网作为本地各专用网之间的通信载体、需要对数据进行加密。
- 【$\mathrm{IP}$广播】：①受限（有限）广播地址，$\mathrm{IP}$地址为全一，名义是整个$IP$网络的网络广播地址，但是由于路由器对广播域的隔离作用，实际表现为对本网络的广播；②直接广播地址，即网络地址将主机号位全部置一。
- 【不应发送$\mathrm{ICMP}$差错报文的情况】：$\mathrm{ICMP}$差错报文本身、第一个分片的数据报片之后的所有后续数据报片、组播地址、$127.0.0.1$、$0.0.0.0$。
- 【$\mathrm{ping}$命令】：使用$ICMP$回送请求和回答报文测试连通性、工作在应用层但不使用$TCP$或$UDP$直接使用$\mathrm{ICMP}$。
