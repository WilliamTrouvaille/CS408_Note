# 第一章 计算机网络体系结构

## 导读

### 【考纲内容】

1.   计算机网络概述
     +   计算机网络的概念、组成与功能
     +   计算机网络的分类
     +   计算机网络的性能指标
2.   计算机网络体系结构与参考模型
     +   计算机网络分层结构
     +   计算机网络协议、接口、服务的概念
     +   $ISO/OSI$参考模型和$TCP/IP$模型

### 【知识导图】

![abe28e4716b74e5baf087494dd0c769e~tplv-k3u1fbpfcp-zoom-in-crop-mark_1512_0_0_0](https://trouvaille-oss.oss-cn-beijing.aliyuncs.com/picList/202307271126370.webp)

### 【复习提示】

+   本章主要介绍计算机网络体系结构的基本概念，读者可以在理解的基础上适当地记忆
+   重点掌握网络的分层结构
    +   包括$5$层和$7$层结构
    +   尤其是$ISO/OSI$参考模型各层的功能及相关协议、 接口和服务等概念
+   掌握有关网络的各种性能指标，特别是时延、带宽、速率和吞吐量等的计算。

## 计算机网络功能

+ 数据通信
    + 最基本功能
    + 也是实现其他功能的基础

+ 资源共享（硬件、软件、数据）
+ 分布式处理
+ 信息综合处理
+ 提高可靠性
+ 负载均衡

计算机网络的三大主要功能是数据通信、资源共享及分布式处理。

## 标准化*

### 标准的分类

+ 法定标准：由权威机构制定的正式合法的标准，如$OSI$。
+ 事实标准：某些公司产品在竞争中占据主流，其产品的协议与技术就成为了标准，如$TCP/IP$。

### 工作阶段

$RCF$（$Request For Comments$）因特网标准形式。

+ 因特网草案（$Internet\，Draft$）。
+ 建议标准（$Proposed\，Standard$）。
+ ~~草案标准（$Draft\，Standard$）。~~
+ 因特网标准（$Internet\，Standard$）。

### 相关组织

+ 国际标准化组织$ISO$：$OSI$、$HDLC$。
+ 国际电信联盟$ITU$：制定通信规则。
+ 国际电气电子工程师协会$IEEE$：$IEEE802$。
+ 因特网工程任务组$IETF$：因特网标准制定。

## 计算机组成

+ 从组成部分上看：硬件、软件、协议。
    + 硬件主要由主机（也称端系统）、通信链路（如双绞线、光纤）、交换设备（如路由器、交换机等）和通信处理机（如网卡）等组成
    + 软件主要包括各种实现资源共享的软件和方便用户使用的各种工具软件
        + 如网络操作系统、邮件收发程序、FTP程序、聊天程序等
        + 软件部分多属于应用层。

    + 协议是计算机网络的核心，如同交通规则制约汽车驾驶一样，协议规定了网络传输数据时所遵循的规范

+ 工作方式：边缘部分、核心部分
    + 边缘部分由所有连接到因特网上、供==用户直接使用==的主机组成，用来进行通信（如传输数据、音频或视频）和资源共享
        + 包括$C/S$与$P2P$方式

    + 核心部分由大量的网络和连接这些网络的路由器组成，它为边缘部分提供连通性和交换服务

+ 功能组成：通信子网、资源子网
    + 通信子网由各种传输介质、 通信设备和相应的网络协议组成，它使网络具有数据传输、交换、控制和存储的能力， 实现联网计算机之间的==数据通信==
        + 硬件设备
            + 路由器（Router）：用于在不同网络之间转发数据包，并根据目标IP地址选择最佳路径。
            + 交换机（Switch）：用于在局域网内部传输数据，根据MAC地址将数据包交付给正确的目标设备。
            + 光纤、电缆等传输介质：用于在网络中传输数据的物理媒介。
            + 网桥

        + 对应于$OSI$参考模型的下三层，包括物理层、数据链路层和网络层

    + 资源子网是实现==资源共享==功能的设备及其软件的集合，向网络用户提供共享其他计算机上的硬件资源、软件资源和数据资源的服务
        + 硬件设备
            + 服务器（Server）：用于存储和提供各种服务，如文件共享、Web服务、数据库等。
            + 存储设备（Storage Device）：用于存储大量数据，提供网络存储服务。
            + 打印机（Printer）：用于提供网络打印服务，使得多台计算机可以通过网络共享打印设备。

        + 对应于$OSI$参考模型的上三层，包括会话层、表示层、应用层


>   需要注意的是，通信子网和资源子网并不是严格区分的两个实体，它们通常是相互交织在一起的。网络中的路由器和交换机既可以属于通信子网，又可以连接到资源子网中的服务器和其他资源设备。这种交织使得整个计算机网络能够高效地传输数据并提供各种服务。

## 计算机分类

+ 按分布范围分类

    + 广域网$WAM$（交换技术）
        + 覆盖范围通常是直径为几十千米到几千千米的区域
        + 因而有时也称**远程网**
        + 广域网是因特网的核心部分
        + 连接广域网的各结点交换机的链路一般都是高速链路，具有较大的通信容量

    + 城域网$MAN$
        + 覆盖区域的直径范围是$5〜50km$
        + 城域网大多采用**以太网技术**，因此有时也常并入局域网的范围讨论

    + 局域网$LAN$（广播技术）
        + 覆盖范围较小，通常是直径为几十米到几千米的区域
        + 传统上，局域网使用广播技术，而广域网使用交换技术

    + 个人区域网$PAN$
        + 覆盖区域的直径约为$10m$
        + 也常称为无线个人区域网$WPAN$

+ 按传输技术分类：广播式、点对点式。

    + 广播式网络。所有联网计算机都共享一个公共通信信道。当一台计算机利用共享通信信道发送报文分组时，所有其他的计算机都会“收听”到这个分组。接收到该分组的计算机将通过检查目的地址来决定是否接收该分组。
        + 局域网基本上都采用广播式通信技术，广域中的无线、卫星通信网络也采用广播式通信技术。
        + 广播式网络共享广播信道（如总线），通常是局域网的一种通信方式（局域网工作在数据链路层）
        + 因此不需要网络层，因而也不存在路由选择问题
        + 但数据链路层使用物理层的服务必须通过服务访问点实现
    + 点对点网络。每条物理线路连接一对计算机。若通信的两台主机之间没有直接连接的线
        路，则它们之间的分组传输就要通过中间结点进行接收、存储和转发，直至目的结点。 

+ 按使用者分类：公用网、专用网。

+ 按交换技术分类：电路交换、报文交换、分组交换。

+ 按拓扑结构分类：总线、星型、环型、网状。

    + ![image-20230725115221513](https://trouvaille-oss.oss-cn-beijing.aliyuncs.com/picList/202307251152584.png)

    1.   总线形网络
         +   优点是建网容易、增/减结点方便、节省线路
         +   缺点是重负载时通信效率不高、总线任意一处对故障敏感。
    2.   星形网络
         +   便于集中控制和管理，因为端用户之间的通信必须经过中央设备
         +   缺点是成本高、中央设备对故障敏感
         +   用一个结点作为中心结点，其他$n-1$个结点直接与中心结点相连构成的网络
         +   中心结点既可以是文件服务器，也可以是连接设备
         +   常见的中心结点为集线器。
    3.   环形网络
         +   最典型的例子是==令牌环局域网==
         +   环可以是单环，也可以是双环
         +   环中信号是单向传输的
    4.   网状网络
         +   每个结点至少有两条路径与其他结点相连，==多用在广域网==中
         +   其有规则型和非规则型两种
         +   其优点是可靠性高
         +   缺点是控制复杂、线路成本高。

    +   以上4种基本的网络拓扑结构可以互连为更复杂的网络

### 按交换技术分类

#### 电路交换

1. 建立连接（电路建立）。
2. 通信。
3. 释放连接（拆除电路）。

链路支持多路复用（可参考数据链路层的$TDM$等）。

优点：

1. 通信时延小，速度快。
2. 有序传输。
3. 无冲突争用。
4. 实时性强。

缺点：

1. 建立连接时间长。
2. 线路独占，使用效率低。
3. 灵活性较差。
4. 不能流量控制。
5. 无差错控制能力。

#### 报文交换

报文：源应用发送的信息整体。

1. 源先根据报文加上IP地址，物理地址等，通过物理层发送。
2. 交换机收到报文之后，先进行存储，等待链路空闲之后进行转发，但是转发的路径不是固定的，是比较随机的。
3. 最后通过许多交换机最终到达目的地。

优点：

1. 无需建立连接。
2. 存储转发，动态分配线路。
3. 线路可靠性高。
4. 线路利用率较高。
5. 多目标服务。

缺点：

1. 有存储转发时延。
2. 报文大小不定，需要网络结点有较大的缓存空间。

所以报文交换不能应用于实时通讯，如电话，视频。

#### 分组交换

将大的数据块分割为小的数据块。分组交换和报文交换基本相同，就是将报文切割之后再进行发送。

==现在的主流网络基本上都可视为分组交换网络。==

优点：

1. 无需建立连接。
2. 存储转发，动态分配线路。
3. 线路可靠性高。
4. 线路利用率较高。
5. 分组大小一定，存储管理更容易。
6. 分组更小，所以传输时延比报文交换的更小。

缺点：

1. 有存储转发时延。
2. 需要传输额外的信息量（编号、目的地址等）。
3. 乱序到达目的主机时，需要对分组进行排序。

>   1. 报文交换和分组交换都采用存储转发。
>   2. 传输数据量大且传输时间远大于呼叫时间，就选择电路交换，其传输时延最小。
>   3. 报文交换分组交换在信道利用率上优于电路交换。

![数据交换](https://trouvaille-oss.oss-cn-beijing.aliyuncs.com/picList/202307251139568.png)

## 分组交换传输方式

数据报和分组的关系：分组是一段比较长的数据，将它进行切割成一段段之后就得到数据报。其都是网络层的传输单位。

分组交换分为数据报方式和虚电路方式两种。

对于出错率高的线路应该使用数据报方式。

### 数据报方式

+ 提供无连接服务，可随时发送和接受。
+ 尽最大可能交付，所以不保证可靠性。
+ 不事先为分组的传输确定传输路径，每个分组独立确定传输路径，不同分组传输路径可能不同，也不一定按序到达。
+ 每个分组携带源和目的地址。
+ 存储转换需要排队等待。当出现拥塞时会丢弃部分分组。
+ 可及时更新转发表，适应性强。
+ 时延小，提高吞吐量。
+ 不单独占用信道，资源利用率高。
+ 路由器根据分组的目的地址转发组：基于路由协议/算法构建转发表（目的网络地址与链路接口的散列对）；检索转发表；每个分组独立选路。

### 虚电路方式

+ 虚电路将数据报方式与电路交换方式结合。
+ 虚电路是一条源主机到目的主机类似电路的逻辑连接，路径上所有结点都要维持该虚电路的建立，都维持一张虚电路表，每一项都记录一个打开的虚电路的信息。
+ 虚电路方式提供连接服务，首先为分组的传输确定传输路径，然后沿该路径/连接传输系列分组，分组的传输路径相同，结束后拆除连接。
+ 一条物理链路可能有多个逻辑电路。
+ 虚拟电路包含临时和永久两种：
    + 永久性虚电路$PVC$：是一种提前定义好的、基本上不需要任何建立时间的端点之间的连接。
    + 交换型虚电路$SVC$：是端点之间的一种临时性连接，这些连接只持续所需的时间，并且在会话结束时就取消这种连接，B错误。

传输过程：

1. 建立虚电路连接：每个分组携带虚电路标识（$VCID$），而非目的地址，源主机发送呼叫请求分组并收到呼叫应答分组后才算建立连接。
2. 数据传输：全双工通信。
3. 释放虚电路连接：源主机发送释放请求分组以拆除虚电路。

优点：

+ 虚电路通信链路建立拆除需要时间，不适合交互式和小量短分组，适合长时间频繁数据交换。
+ 链路建立确定传输路径。
+ 可靠通信，保证有序到达。
+ 提供流量控制。
+ 虚电路某点或某部分破坏，则会影响其他相关电路。
+ 分组首部不包含目的地址，包含虚电路标识符，开销小。

|       &nbsp;       |           数据报服务           |                     虚电路服务                     |
| :----------------: | :----------------------------: | :------------------------------------------------: |
|      建立连接      |              不用              |                        必须                        |
|      目的地址      |  每个分组都要有完成的目的地址  | 仅在建立连接时使用，之后每个分组使用较短的虚电路号 |
|      路由选择      | 每个分组单独进行路由选择与转发 |      属于同一条虚电路的分组按照同一个路由转发      |
|      分组顺序      |         不保证有序到达         |                    保证有序到达                    |
|       可靠性       | 不保证，可靠性依靠用户主机保证 |                        保证                        |
|   网络故障适应性   |               强               |                         弱                         |
| 差错控制和流量控制 |          用户主机完成          |          可由网络完成也可以由用户主机完成          |

## 性能指标

### 带宽$Bandwidth$

计算机网络中，带宽表示网络的通信线路所能传送数据的能力，是网络中某点到另外一点所能通过的**最高数据率**，单位是比特每秒$b/s$。即网络设备发送的极限最高速率约束。

+   带宽也常表示示通信线路允许通过的信号频带范围，单位是赫兹$Hz$

### 时延$Delay$

是数据从网络的一端传送到另一端所需要的时间，单位为$s$。==总时延=发送时延+传播时延+排队时延+处理时延==。

+ 发送时延：从发送分组的第一个比特开始到最后一个比特发送完毕的时间
    + ==发送时延=数据长度$\div$信道带宽（发送速率）==
+ 传播时延：数据在信道上传播的时间
    + ==传播时延=信道长度$\div$电磁波传播速率。==
+ 排队时延：等待输入与输出链路可用的时间。
+ 处理时延：检错数据与查找转发出口的时间。

>   做题时，排队时延和处理时延一般可忽略不计（除非题目另有说明）
>
>   另外，对于高速链路，提高的仅是数据发送速率而非比特在链路上的传播速率
>
>   提高数据的发送速率只是为了减少数据的发送时延。

### 时延带宽积

指发送端发送的第一个比特即将到达终点时，发送端已经发出了多少个比特，因此又称以比特为单位的**链路长度**

==时延带宽积=传播时延$\times$带宽，单位为$bit$。==

### 往返时延$RTT$

从发送方发送数据开始，到发送方收到接收方的确认（假如收到数据立刻返回确认）总共经历的时延。

$RTT$越大，在收到确认前可以发送的数据越多。

==$RTT$=往返传播时延+末端处理时延。==

### 吞吐量$Throughput$

单位时间内通过某网络或信道接口的数据量，单位是$b/s$等。这是网络实际的平均速率。吞吐量受网络带宽的限制。

### 速率$Speed$

数据传输率或比特率。是主机在数字信道上传输数据位数的额定理想速度。

+   $1Tb/s=10^3Gb/s=10^6Mb/s=10^9kb/s=10^{12}b/s$。
    +   小写的$b$代表比特

存储容量方面，$1Byte=8bit$，因为一个字节占八个比特位，所以一般都是以字节为单位。

+   $1TB=2^{10}GB=2^{20}MB=2^{30}KB=2^{40}B$。
    +   大写的$B$代表字节
    +   ==$1Byte=8bit$==

>   对于生活中常见的单位$MBPS$，实际上和$Mb/s$一样(其中$P$表示$per$，"每"的意思，完全翻译为兆比特每秒)

### 利用率

+ 信道利用率：有数据通过时间\（有+无）数据通过时间。
+ 网络利用率：信道利用率加权平均值。

利用率越高则时延越长，且加速度不断提高。

## 计算机网络体系结构

![image-20230725223450615](https://trouvaille-oss.oss-cn-beijing.aliyuncs.com/picList/202307252234409.png)

### 分层原因

+ 发起通信的计算机必须将数据通信的通路进行激活。
+ 要告诉网络如何识别目的主机。
+ 发起通信的计算机要查明目的主机是否开机，并且与网络连接正常。
+ 发起通信的计算机要弄清楚，对方计算机中文件管理程序是否已经做好准备工作。
+ 确保差错和意外可以解决。

### 分层结构概念

![image-20230725202924377](https://trouvaille-oss.oss-cn-beijing.aliyuncs.com/picList/202307252029519.png)

+ 实体：第$n$层中的活动元素称为$n$层实体

    + 同一层的实体就是对等实体。

+ 协议：为进行网络中的对等实体数据交换而建立的规则、标准或约定。是水平方向的。
    + 协议由语法、语义和同步三部分组成
        + 语法：传输数据的格式。
        + 语义：规定所要完成的功能，即需要发出何种控制信息、完成何种动作及做出何种应答
        + 同步：规定执行各种操作的条件、时序关系等，即事件实现顺序的详细说明
    + 一个完整的协议通常应具有线路管理（建立、释放连接）、差错控制、数据转换等功能。

+ 接口：接口是同一结点内相邻两层间交换信息的连接点，是一个系统内部的规定。

    + 上层使用下层服务的入口。
    + 接口连接的是相邻层次。
    + 在典型的接口上，同一结点相邻两层的实体通过访问服务点$SAP$进行交互
        + 服务是通过$SAP$提供给上层使用的，第$n$层的$SAP$就是第$n+1$层可以访问第$n$层服务的地方
        + 每个$SAP$都有一个能够标识它的地址

+ 服务：下层为相邻上层提供的功能调用。是垂直方向的。
    + 上层使用下层提供的服务。
    + 第$n$层向$n+1$层提供服务时，不仅包括第$n$层本身的功能，还包括下面所有层次所提供的所有功能。
        + 最低层只提供服务，是整个层次结构的基础
        + 中间各层既是下一层的服务使用者，又是上一层的服务提供者
        + 最高层面向用户提供服务
    + 上一层只能通过相邻层间的接口使用下一层的服务，而不能调用其他层的服务
        + 下一层所提供服务的实现细节对上一层透明
    + 两台主机通信时，对等层在逻辑上有一条直接信道，表现为不经过下层就把信息传送到对方
    + 协议是“水平的”，即协议是控制对等实体之间通信的规则。但服务是“垂直的”，即服务是由下层通过层间接口向上层提供的
    + 并非在一层内完成的全部功能都称为服务，==只有那些能够被高一层实体“看得见”的功能才称为服务==。
    + 上层使用下层所提供的服务时必须与下层交换一些命令，这些命令在$OSI$参考模型中称为**服务原语**
        1.   请求$Reques$t。由服务用户发往服务提供者，请求完成某项工作。
        2.   指示$Indication$。由服务提供者发往服务用户，指示用户做某件事情。
        3.   响应$Response$。由服务用户发往服务提供者，作为对指示的响应。
        4.   证实$Confirmation$。由服务提供者发往服务用户，作为对请求的证实。 
    + 服务类型：
        1.   面向连接服务与无连接服务。
             +   在面向连接服务中，通信前双方必须先建立连接，分配相应的资源(如缓冲区)，以保证通信能正常进行，传输结束后释放连接和所占用的资源
                 +   因此这种服务可以分为==连接建立、数据传输和连接释放==三个阶段
                 +   ==例如$TCP$就是一种面向连接服务的协议==
             +   在无连接服务中，通信前双方不需要先建立连接，需要发送数据时可直接发送，把每个带有目的地址的包(报文分组)传送到线路上，由系统选定路线进行传输
                 +   这是一种不可靠的服务
                 +   这种服务常被描述为“尽最大努力交付” $Best-Effort-Delivery$，它并不保证通信的可靠性。
                 +   例如$IP、UDP$就是一种无连接服务的协议。
        2.   可靠服务和不可靠服务。
             +   可靠服务是指网络具有纠错、检错、应答机制，能保证数据正确、可靠地传送到目的地
             +   不可靠服务是指网络只是尽量正确、可靠地传送，而不能保证数据正确、可靠地传送到目的地，是一种尽力而为的服务
             +   对于提供不可靠服务的网络，其网络的正确性、可靠性要由应用或用户来保障
                 +   例如，用户收到信息后要判断信息的正确性，如果不正确，那么用户要把出错信息报告给信息的发送者，以便发送者采取纠正措施
                 +   通过用户的这些措施，可以把不可靠的服务变成可靠的服务
        3.   有应答服务和无应答服务
             +   有应答服务是指接收方在收到数据后向发送方给出相应的应答，该应答由传输系统内部自动实现，而不由用户实现
                 +   所发送的应答既可以是肯定应答，也可以是否定应答，通常在接收到的数据有错误时发送否定应答。
                 +   例如，文件传输服务就是一种有应答服务
             +   无应答服务是指接收方收到数据后不自动给出应答。若需要应答，则由高层实现
                 +   例如，对于$WWW$服务，客户端收到服务器发送的页面文件后不给出应答。

+ $SDU$服务数据单元：为完成用户所要求的功能而应传输的数据。

    + 第$n$层的服务数据单元记为$n-SDU$
    + 即要传输的目的数据。
    + 通俗来讲就是你这层收到的东西

+ $PCI$协议控制信息：控制协议操作的信息。

    + 第$n$层的协议控制信息记为$n-PCL$
    + 即协议控制头
    + 通俗来讲就是你这层要加的东西

+ $PDU$协议数据单元：对等层次之间传送的数据单位。

    + 第$n$层的协议控制信息记为$n-PDU$
    + 通俗来讲就是你这层要传的东西

+ $n+1$$n-1$层的$PDU$作为第$n$层的$SDU$，在加上本层的$PCI$就变成了本层的$PDU$，然后交给$n-1$层后作为$SDU$发送。所以
    $$
    SDU_{n}+PCI_{n}=PDU_{n}=SDU_{(n-1)}
    $$

    + 这里由于写成类似$n-SDU$的形式不太好看更难理解，我改了下方便理解
    + 物理层的$PDU$为比特，数据链路层的$SDU$为帧，网络层的$SDU$为分组，传输层的$PDU$为报文段。


### OSI参考模型

为一个法定标准，但是没有实现。为$ISO$于$1984$年提出的开放系统互连模型。

#### 物理层$Physical\;Layer$

+   物理层的传输单位是比特，功能是在物理媒体上为数据端设备透明地传输原始比特流

+   物理层主要定义数据终端设备$DTE$和数据通信设备$DCE$的物理与逻辑连接方法，所以物理层协议也称**物理层接口标准**

+   由于在通信技术的早期阶段，通信规则称为规程$Procedure$，因此物理层协议也称**物理层规程**

+   物理层接口标准很多，如$EIA-232C、EIA/TIA RS-449、 CCITT$的$X.21$等。在计算机网络的

    +   复习过程中，不要忽略对各层传输协议的记忆，到了后期，读者对数据链路层、网络层、传输层和应用层的协议会比较熟悉，但往往容易忽视物理层的协议

+   物理层主要研究以下内容

    1.   通信链路与通信结点的连接需要一些电路接口，物理层规定了这些接口的一些参数，如机械形状和尺寸、交换电路的数量和排列等
         +   例如，笔记本电脑上的网线接口，就是物理层规定的内容之一

    2.   物理层也规定了通信链路上传输的信号的意义和电气特征
         +   例如物理层规定信号$A$代表数字$0$，那么当结点要传输数字$0$时，就会发出信号$A$，当结点接收到信号$A$时，就知
             道自己接收到的实际上是数字$0$

>   注意，传输信息所利用的一些物理媒体，如双绞线、光缆、无线信道等，并不在物理层协议之内而在物理层协议下面。因此，有人把物理媒体当作第0层。

#### 数据链路层$Data\;Link\;Layer$

+   典型的数据链路层协议有$SDLC、HDLC、PPP、STP$和帧中继等。
+   数据链路层的传输单位是帧，任务是将网络层传来的$IP$数据报组装成帧
+   数据链路层的功能可以概括为==封装成帧、差错控制、流量控制和传输管理==等。 
+   广播式网络在数据链路层还要处理新的问题，即如何控制对共享信道的访问。数据链路层的一个特殊的子层一一介质访问子层，就是专门处理这个问题的。 

#### 网络层$Network\;Layer$

+   网络层的传输单位是数据报，它关心的是通信子网的运行控制，主要任务是把网络层的协议数据单元(分组)从源端传到目的端，为分组交换网上的不同主机提供通信服务
+   关键问题是==对分组进行路由选择==，并实现==流量控制、拥塞控制、差错控制和网际互连==等功能。 
+   网络层的协议有$ IP、IPX、ICMP、IGMP、ARP、RARP $和 $OSPF$ 等。

>注意，网络层中的“网络”一词并不是我们通常谈及的具体网络，而是在计算机网络体系结构中使用的专有名词。 

#### 传输层$Transport\;Layer$

+   传输层也称运输层，传输单位是报文段($TCP$)或用户数据报($UDP$)
+   传输层负责主机中两个进程之间的通信，功能是为端到端连接提供可靠的传输服务，为端到端连接提供==流量控制、差错控制、服务质量、数据传输管理==等服务。 
    +   ==数据链路层提供的是点到点的通信，传输层提供的是端到端的通信，两者不同==
    +   通俗地说， 点到点可以理解为主机到主机之间的通信，一个点是指一个硬件地址或IP地址，网络中参与通信的主机是通过硬件地址或IP地址标识的
    +   端到端的通信是指运行在不同主机内的两个进程之间的通信，一个进程由一个端口来标识，所以称为端到端通信。 
+   使用传输层的服务，高层用户可以直接进行端到端的数据传输，从而忽略通信子网的存在。
+   通过传输层的屏蔽，高层用户看不到子网的交替和变化。由于一台主机可同时运行多个进程，因此传输层具有复用和分用的功能
    +   复用是指多个应用层进程可同时使用下面传输层的服务
    +   分用是指传输层把收到的信息分别交付给上面应用层中相应的进程
+   传输层的协议有$TCP、UDP$

#### 会话层

+   会话层允许不同主机上的各个进程之间进行会话。会话层利用传输层提供的端到端的服务， 向表示层提供它的增值服务
+   这种服务主为表示层实体或用户进程建立连接并在连接上有序地传输数据，这就是会话，也称建立同步(SYN)
+   ==会话层负责管理主机间的会话进程，包括建立、管理及终止进程间的会话==
+   会话层==可以使用校验点使通信会话在通信失效时从校验点继续恢复通信，实现数据同步==

#### 表示层

+   表示层主要处理在两个通信系统中交换信息的表示方式。不同机器采用的编码和表示方法不同，使用的数据结构也不同
+   为了使不同表示方法的数据和信息之间能互相交换，==表示层采用抽象的标准方法定义数据结构，并采用标准的编码形式。数据压缩、加密和解密也是表示层可提供的数据表示变换功能。==

#### 应用层$Application\;Layer$

+   应用层是$OSI$参考模型的最高层，是用户与网络的界面。应用层为特定类型的网络应用提供访问OSI参考模型环境的手段
+   因为用户的实际应用多种多样，这就要求应用层采用不同的应用协议来解决不同类型的应用要求，因此应用层是最复杂的一层，使用的协议也最多
+   典型的协议有用于文件传送的$FTP$、用于电子邮件的$SMTP$、用于万维网的$HTTP$等。

---

端系统一般都是七层，而中间系统如路由器等最多只有三层。上面四层是端到端的通信，而下面三层是点到点的通信。

![image-20230725203957683](https://trouvaille-oss.oss-cn-beijing.aliyuncs.com/picList/202307252039802.png)

### TCP/IP参考模型

$ARPA$在研究$ARPAnet$时提出了$ TCP/IP$模型

模型从低到高依次为

+   网络接口层(对应$OSI$参考模型中的物理层和数据链路层)
+   网际层
+   传输层
+   应用层(对应$OSI$参考模型中的会话层、 表示层和应用层)

先有协议栈才有参考模型。

![image-20230725210551976](https://trouvaille-oss.oss-cn-beijing.aliyuncs.com/picList/202307252105052.png)

>   可以看出，IP协议是因特网中的核心协议；TCP/IP可以为各式各样的应用提供服务（所谓的everything over IP）,同时TCP/IP也允许IP协议在由各种网络构成的互联网上运行（所谓的IP over everything）
>
>   正因为如此，因特网才会发展到今天的规模。

#### 网络接口层

+   网络接口层的功能类似于$OSI$参考模型的物理层和数据链路层
+   它表示与物理网络的接口， 但实际上$TCP/IP$本身并未真正描述这一部分，只是指出主机必须使用某种协议与网络连接，以便在其上传递$IP$分组
+   具体的物理网络既可以是各种类型的局域网，如以太网、令牌环网、令牌总线网等，也可以是诸如电话网、$SDH$、$X.25$、帧中继夺口 $ATM$等公共数据网络
+   ==网络接口层的作用是从主机或结点接收$IP$分组，并把它们发送到指定的物理网络上。==

#### 网际层

+   主机-主机
+   网际层是$TCP/IP$体系结构的关键部分
+   网际层和$OSI$参考模型的网络层在功能上非常相似
+   网际层将分组发往任何网络，并为之独立地选择合适的路由，但它不保证各个分组有序地到达，各个分组的有序交付由高层负责
+   网际层定义了标准的分组格式和协议，即IP。当前采用的IP协议是第4版，即IPv4,它的下一版本是IPv6。 

#### 传输层

+   应用-应用或进程-进程
+   传输层的功能同样和$OSI$参考模型中的传输层类似，即使得发送端和目的端主机上的对等实体进行会话传输层主要使用以下两种协议：
    1.   传输控制协议$Transmission Control Protocol, TCP$
         +   它是面向连接的，数据传输的单位是报文段，能够提供可靠的交付。
    2.   用户数据报协议$User Datagram Protocol, UDP$
         +   它是无连接的，数据传输的单位是用户数据报，不保证提供可靠的交付，只能提供“尽最大努力交付”。 

#### 应用层

+   用户-用户
+   应用层包含所有的高层协议
    +   如虚拟终端协议$Telnet$
    +   文件传输协议$FTP$
    +   域名解析服务$DNS$
    +   电子邮件协议$SMTP$
    +   超文本传输协议$HTTP$

#### TCP/IP模型与OSI参考模型的比较

$TCP/IP$模型与$OSI$参考模型有许多相似之处

1.   二者都采取分层的体系结构，将庞大且复杂的问题划分为若干较容易处理的、范围较小的问题，而且分层的功能也大体相似
2.   二者都是基于独立的协议栈的概念
3.   二者都可以解决异构网络的互连，实现世界上不同厂家生产的计算机之间的通信。 

![image-20230725211906023](https://trouvaille-oss.oss-cn-beijing.aliyuncs.com/picList/202307252119108.png)

+ 应用层-应用层+表示层+会话层：$HTTP$、$FTP$、$DNS$。
+ 传输层-传输层：$TCP$、$UDP$。
+ 网际层-网络层：$IP$。
+ 网络接口层-数据链路层+物理层：$Ethernet$、$ATM$、$Frame\;Relay$。

两个模型除具有这些基本的相似之处外，也有很多差别：

1.   $OSI$参考模型的最大贡献就是精确地定义了三个主要概念：服务、协议和接口，这与现代的面向对象程序设计思想非常吻合

     +   而$TCP/IP$模型在这三个概念上却没有明确区分，不符合软件工程的思想。

2.   $OSI$参考模型产生在协议发明之前，没有偏向于任何特定的协议，通用性良好。但设计者在协议方面没有太多经验，不知道把哪些功能放到哪一层更好

     +   $TCP/IP$模型正好相反，首先出现的是协议，模型实际上是对已有协议的描述，因此不会出现协议不能匹配模型的情况，但该模型不适合于任何其他非$TCP/IP$的协议栈。 

3.   $TCP/IP$模型在设计之初就考虑到了多种异构网的互连问题，并将网际协议$IP$作为一个单独的重要层次

     +   $OSI$参考模型最初只考虑到用一种标准的公用数据网将各种不同的系统互连
     +   $OSI$参考模型认识到$IP$的重要性后，只好在网络层中划分出一个子层来完成类似于$TCP/IP$模型中的$IP$的功能。

4.   $OSI$参考模型在网络层支持无连接和面向连接的通信，但在传输层仅有面向连接的通信

     +   而$TCP/IP$模型认为可靠性是端到端的问题，因此它在网际层仅有一种无连接的通信模式， 但传输层支持无连接和面向连接两种模式

     +   ==这个不同点常常作为考查点==

#### 面向连接与无连接

面向连接：

1.   发出请求，建立连接。
2.   传输数据。
3.   释放连接。

无连接直接传输数据。

两个模型之间的连接区别：

| 网络层 | 无连接+面向连接 |     无连接      |
| :----: | :-------------: | :-------------: |
|        |  $OSI$参考模型  |  $TCP/IP$模型   |
| 传输层 |    面向连接     | 无连接+面向连接 |

### 五层参考模型

应用层、传输层、网络层、数据链路层、物理层。

![image-20230725204211462](https://trouvaille-oss.oss-cn-beijing.aliyuncs.com/picList/202307252042548.png)

![image-20230725223533132](https://trouvaille-oss.oss-cn-beijing.aliyuncs.com/picList/202307252235294.png)

![23July31-213458-1690810498-1ba23eeb-5227-4873-b012-efb0d89c90a9](C:/Users/willi/OneDrive/%E5%9B%BE%E7%89%87/ShareX/2023-07/23July31-213458-1690810498-1ba23eeb-5227-4873-b012-efb0d89c90a9.png)
